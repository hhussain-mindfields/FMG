<Activity mc:Ignorable="sap sap2010" x:Class="ValidateNDA_TestCase" this:ValidateNDA_TestCase.in_str_StatusField="Status" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mg="clr-namespace:Microsoft.Graph;assembly=Microsoft.Graph" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:njl="clr-namespace:Newtonsoft.Json.Linq;assembly=Newtonsoft.Json" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ss="clr-namespace:System.Security;assembly=mscorlib" xmlns:this="clr-namespace:" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uma="clr-namespace:UiPath.MicrosoftOffice365.Activities;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umaf="clr-namespace:UiPath.MicrosoftOffice365.Activities.Files;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umam="clr-namespace:UiPath.MicrosoftOffice365.Activities.Mail;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umas="clr-namespace:UiPath.MicrosoftOffice365.Activities.SharePoint;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umm="clr-namespace:UiPath.MicrosoftOffice365.Models;assembly=UiPath.MicrosoftOffice365" xmlns:uta="clr-namespace:UiPath.Testing.Activities;assembly=UiPath.Testing.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_dbl_ApprovedAHT" Type="InArgument(x:Double)" />
    <x:Property Name="in_dbl_RejectedAHT" Type="InArgument(x:Double)" />
    <x:Property Name="in_sstr_Password" Type="InArgument(x:String)" />
    <x:Property Name="in_str_Account" Type="InArgument(x:String)" />
    <x:Property Name="in_str_ApplicationId" Type="InArgument(x:String)" />
    <x:Property Name="in_str_ApprovedFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_EmailAddressField" Type="InArgument(x:String)" />
    <x:Property Name="in_str_FFITeamEmail" Type="InArgument(x:String)" />
    <x:Property Name="in_str_FullNameField" Type="InArgument(x:String)" />
    <x:Property Name="in_str_RejectedFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPApprovedFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPIndNDARegList" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPListSite" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPRejectedFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_StorageBucket" Type="InArgument(x:String)" />
    <x:Property Name="in_str_TenantId" Type="InArgument(x:String)" />
    <x:Property Name="in_str_Username" Type="InArgument(x:String)" />
    <x:Property Name="in_str_TestResult" Type="InArgument(x:String)" />
    <x:Property Name="in_str_TestScenario" Type="InArgument(x:String)" />
    <x:Property Name="in_int_TestCase" Type="InArgument(x:Int32)" />
    <x:Property Name="in_bln_Approved" Type="InArgument(x:Boolean)" />
    <x:Property Name="in_str_FullName" Type="InArgument(x:String)" />
    <x:Property Name="in_str_EmailAddress" Type="InArgument(x:String)" />
    <x:Property Name="in_str_StatusField" Type="InArgument(x:String)" />
    <x:Property Name="in_str_ProcessingFolder" Type="InArgument(x:String)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1229,11144</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ValidateNDA_TestCase_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="50">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Security</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>System.Dynamic</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Collections.Specialized</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>UiPath.Web.Activities</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>Microsoft.Graph</x:String>
      <x:String>UiPath.MicrosoftOffice365.Enums</x:String>
      <x:String>UiPath.MicrosoftOffice365.Models</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>UiPath.Testing</x:String>
      <x:String>UiPath.Testing.Activities</x:String>
      <x:String>UiPath.Shared.Telemetry</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Files</x:String>
      <x:String>UiPath.Core.Activities.Storage</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.SharePoint</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="37">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.Web.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>Microsoft.Graph</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Testing</AssemblyReference>
      <AssemblyReference>UiPath.Testing.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Persistence.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.Graph.Core</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Sequence sap2010:Annotation.AnnotationText="Description: Test cases/script for ValidateNDA.&#xA;&#xA;Arguments:&#xA;in_qi_TransactionItem - Queue/Transaction item retrieved from FetchEmail.&#xA;in_o365m_ProcessingMail - Processing folder mail retreived from FetchEmail.&#xA;in_di_SubFolders - Drive item list that stores the information of Subfolder within the root folder retrieved from FetchEmail.&#xA;in_di_Attachment - Drive item that store the information of the PDF file uploded to Validate folder retrieved from FetchEmail..&#xA;in_str_Pg2StoragePath - Storage bucket path where Pg2 img. is uploaded retrieved from FetchEmail..&#xA;in_str_Pg6StoragePath - Storage bucket path where Pg2 img. is uploaded retrieved from FetchEmail..&#xA;in_str_ApplicationId - Applicant ID for o365.&#xA;in_str_TenantId - Tenant ID for o365.&#xA;in_str_Username - AD Username for o365.&#xA;in_sstr_Password - Password (SecureString) for o365.&#xA;in_str_Account - Mail account to perform mail operations.&#xA;in_str_ApprovedFolder - Mail folder to place/move the mail that is approved.&#xA;in_str_RejectedFolder - Mail folder to place/move the invalid/no attachment mail.&#xA;in_str_ExpFolder - Mail folder to place/move the mail when an exception is encountered.&#xA;in_str_SPSite - SharePoint site to perform file operations.&#xA;in_str_SPRootFolder - SharePoint Root folders.&#xA;in_str_SPApprovedFolder - Approved (subfolder) within root folder.&#xA;in_str_SPRejectedFolder - Rejected (subfolder) within root folder.&#xA;in_str_StorageBucket - Orchestrator storage bucket to store and retreive Pg2 and Pg6 img.&#xA;in_str_ActionCatalog - Action catalog name to tag the actions.&#xA;in_dbl_ApprovedAHT - AHT value for Approved scenario.&#xA;in_dbl_RejectedAHT - AHT value for Rejected scenario.&#xA;in_str_SPListSite - SharePoint site to perform list operations.&#xA;in_str_SPIndNDARegList - Individual NDA Register SharePointList name.&#xA;in_str_EmailAddressField - Email address field name for SharePoint List Item filter.&#xA;in_str_FullNameField - Full name field name for SharePoint List Item filter.&#xA;in_str_FFITeamEmail - FFI Team email address.&#xA;&#xA;Outcomes:&#xA;Successful - Approved: Action triggered for user to Approve the NDA, resumes once approved, moves the file to Approved folder, deletes pg2 and pg6 img from storage bucket and updates the registry.&#xA;Successful - Rejected: Action triggered for user to Reject the NDA, resumes once rejected, moves the file to Rejectedfolder, deletes pg2 and pg6 img from storage bucket and notifies the requestor.&#xA;Unsuccessful -Exception thrown detailing the error that occurred." DisplayName="ValidateNDA_TestCase" sap:VirtualizedContainerService.HintSize="1239,11079" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="str_ApplicationId" />
      <Variable x:TypeArguments="x:String" Name="str_TenantId" />
      <Variable x:TypeArguments="ss:SecureString" Name="sstr_Password" />
      <Variable x:TypeArguments="x:String" Name="str_Username" />
      <Variable x:TypeArguments="x:String" Name="str_MSOffice" />
      <Variable x:TypeArguments="njl:JObject" Name="jobj_MSOffice" />
      <Variable x:TypeArguments="x:String" Name="str_PDFPath" />
      <Variable x:TypeArguments="mg:DriveItem" Name="di_Attachment" />
      <Variable x:TypeArguments="mg:DriveItem[]" Name="di_SubFolders" />
      <Variable x:TypeArguments="umm:Office365Message" Name="o365m_ProcessingMail" />
      <Variable x:TypeArguments="ui:QueueItem" Name="qi_TransactionItem" />
      <Variable x:TypeArguments="x:String" Name="str_Pg2StoragePath" />
      <Variable x:TypeArguments="x:String" Name="str_Pg6StoragePath" />
      <Variable x:TypeArguments="s:Exception" Name="exc_Exception" />
      <Variable x:TypeArguments="x:String" Name="str_ProcessingFolder" />
      <Variable x:TypeArguments="x:String" Name="str_QueueName" />
      <Variable x:TypeArguments="x:String" Name="str_SPRootFolder" />
      <Variable x:TypeArguments="x:String" Name="str_SPSite" />
      <Variable x:TypeArguments="x:String" Name="str_SPValidateFolder" />
      <Variable x:TypeArguments="umm:Office365Message[]" Name="o365m_Mails" />
      <Variable x:TypeArguments="umm:Office365SharepointList" Name="o365SPL_IndNDAReg" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_NDARegister" />
      <Variable x:TypeArguments="umm:Office365SharepointListItem[]" Name="o365SPLI_ListItems" />
      <Variable x:TypeArguments="x:String" Name="str_TranRef" />
      <Variable x:TypeArguments="x:String" Name="str_SPSubFolder" />
      <Variable x:TypeArguments="x:String" Name="str_MailSubFolder" />
      <Variable x:TypeArguments="s:DateTime" Default="[Now]" Name="dati_ExeutedDate" />
      <Variable x:TypeArguments="mg:DriveItem[]" Name="di_Files" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1197,91" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Started.&quot;]" />
    <Sequence DisplayName="... Given" sap:VirtualizedContainerService.HintSize="1197,8169" sap2010:WorkflowViewState.IdRef="Sequence_2">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="831,91" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Test Case No..: &quot; +in_int_TestCase.ToString+ &quot;, Test Scenario: &quot; +in_str_TestScenario+ &quot;.&quot;]" />
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="831,91" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Getting AD credentials.&quot;]" />
      <ui:GetRobotCredential TimeoutMS="{x:Null}" AssetName="AD_ANHANSEN_LBISHOP" DisplayName="Get Credential: AD" sap:VirtualizedContainerService.HintSize="831,79" sap2010:WorkflowViewState.IdRef="GetRobotCredential_1" Password="[sstr_Password]" Username="[str_Username]" />
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="831,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Getting MSOffice365 connection data.&quot;]" />
      <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="MSOffice365_ConnectionData" DisplayName="Get Asset: MSOffice365" sap:VirtualizedContainerService.HintSize="831,137" sap2010:WorkflowViewState.IdRef="GetRobotAsset_1">
        <ui:GetRobotAsset.Value>
          <OutArgument x:TypeArguments="x:String">[str_MSOffice]</OutArgument>
        </ui:GetRobotAsset.Value>
      </ui:GetRobotAsset>
      <ui:DeserializeJson x:TypeArguments="njl:JObject" DisplayName="Deserialize JSON" sap:VirtualizedContainerService.HintSize="831,60" sap2010:WorkflowViewState.IdRef="DeserializeJson`1_1" JsonObject="[jobj_MSOffice]" JsonString="[str_MSOffice]" />
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="831,91" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Setting up MSOffice365 connection and credential test data.&quot;]" />
      <Sequence sap2010:Annotation.AnnotationText="The input arguments for the test scenarios here use the word 'Default' to represent whether the default value from the connection and credential assets should be used. These IF statements check if it's Default and if it is, then it grabs the correct asset value. If it isn't, then it just uses the existing input value." DisplayName="Sequence: If Defaults" sap:VirtualizedContainerService.HintSize="831,1199" sap2010:WorkflowViewState.IdRef="Sequence_5">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If Condition="[in_str_ApplicationId = &quot;Default&quot;]" DisplayName="If: Application Id is Default" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_1">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <If.Then>
            <Assign DisplayName="Assign: Application Id" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[str_ApplicationId]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[jobj_MSOffice("ApplicationId").ToString]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Then>
          <If.Else>
            <Assign DisplayName="Assign: Application Id" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[str_ApplicationId]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[in_str_ApplicationId]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Else>
        </If>
        <If Condition="[in_str_TenantId = &quot;Default&quot;]" DisplayName="If: Tenant Id is Default" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_2">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <If.Then>
            <Assign DisplayName="Assign: Tenant Id" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_3">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[str_TenantId]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[jobj_MSOffice("TenantId").ToString]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Then>
          <If.Else>
            <Assign DisplayName="Assign: Tenant Id" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_4">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[str_TenantId]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[in_str_TenantId]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Else>
        </If>
        <If Condition="[in_str_Username &lt;&gt; &quot;Default&quot;]" DisplayName="If: Username is NOT Default" sap:VirtualizedContainerService.HintSize="569,247" sap2010:WorkflowViewState.IdRef="If_3">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <If.Then>
            <Assign DisplayName="Assign: Username" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_5">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[str_Username]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[in_str_Username]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Then>
        </If>
        <If Condition="[in_sstr_Password &lt;&gt; &quot;Default&quot;]" DisplayName="If: Password is NOT Default" sap:VirtualizedContainerService.HintSize="569,247" sap2010:WorkflowViewState.IdRef="If_4">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <If.Then>
            <Assign DisplayName="Assign: Password" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_6">
              <Assign.To>
                <OutArgument x:TypeArguments="ss:SecureString">[sstr_Password]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="ss:SecureString">[New Net.NetworkCredential("",in_sstr_Password).SecurePassword]</InArgument>
              </Assign.Value>
            </Assign>
          </If.Then>
        </If>
      </Sequence>
      <uma:Office365ApplicationScope ApplicationSecret="{x:Null}" CertificateAsBase64="{x:Null}" CertificatePassword="{x:Null}" ContinueOnError="{x:Null}" Password="{x:Null}" SecureApplicationSecret="{x:Null}" ApplicationId="[str_ApplicationId]" AuthenticationType="UsernameAndPassword" DisplayName="Microsoft Office 365 Scope: Send Test Case Mail" Environment="Global" sap:VirtualizedContainerService.HintSize="831,5918" sap2010:WorkflowViewState.IdRef="Office365ApplicationScope_1" OAuthApplication="Custom" SecurePassword="[sstr_Password]" Services="Mail" Tenant="[str_TenantId]" Timeout="300000" Username="[str_Username]">
        <uma:Office365ApplicationScope.Body>
          <ActivityAction x:TypeArguments="mg:GraphServiceClient">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="mg:GraphServiceClient" Name="ParentScope" />
            </ActivityAction.Argument>
            <Sequence DisplayName="Sequence: Send Test Case Mail" sap:VirtualizedContainerService.HintSize="797,5832" sap2010:WorkflowViewState.IdRef="Sequence_11">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:MultipleAssign DisplayName="Multiple Assign: Initialise FetchEmail variables" sap:VirtualizedContainerService.HintSize="755,284" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
                <ui:MultipleAssign.AssignOperations>
                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_ProcessingFolder]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[in_str_ProcessingFolder]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_QueueName]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">LGL_NDAReceiving</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_SPSite]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">https://fmgl.sharepoint.com/sites/RPATeam</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_SPRootFolder]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">RPA Sandbox/LGL_NDAReceiving/ValidateNDA</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_SPValidateFolder]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">01.Validate</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_Pg2StoragePath]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">Pg2.png</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_16">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[str_Pg6StoragePath]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">Pg6.png</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                  </scg:List>
                </ui:MultipleAssign.AssignOperations>
              </ui:MultipleAssign>
              <Sequence DisplayName="Sequence: Send &amp; Retrieve Email Mail" sap:VirtualizedContainerService.HintSize="755,1589" sap2010:WorkflowViewState.IdRef="Sequence_19">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <umam:SendMail AttachmentsCollection="{x:Null}" Bcc="{x:Null}" Body="{x:Null}" Cc="{x:Null}" From="{x:Null}" ReplyTo="{x:Null}" Account="[in_str_Account]" DisplayName="Send Mail: Test scenario mail" sap:VirtualizedContainerService.HintSize="627,350" sap2010:WorkflowViewState.IdRef="SendMail_1" Importance="Normal" IsBodyHTML="False" IsDraft="False" Subject="[&quot;NDA_Receiving_ValidateNDA_TC&quot; +in_int_TestCase.ToString]" To="[str_Username.Split(&quot;;&quot;c)]">
                  <umam:SendMail.Attachments>
                    <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4" />
                  </umam:SendMail.Attachments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </umam:SendMail>
                <ui:InterruptibleWhile Condition="[1=1]" DisplayName="While: Loop till Mail found in str_ProcessingFolder" sap:VirtualizedContainerService.HintSize="627,976" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_1">
                  <ui:InterruptibleWhile.Body>
                    <Sequence DisplayName="Body: Get Mail" sap:VirtualizedContainerService.HintSize="591,811" sap2010:WorkflowViewState.IdRef="Sequence_8">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <umam:GetMail Query="{x:Null}" Account="[in_str_Account]" DisplayName="Get Mail: str_ProcessingFolder" GetAsHTML="False" sap:VirtualizedContainerService.HintSize="549,22" sap2010:WorkflowViewState.IdRef="GetMail_1" MailFolder="[str_ProcessingFolder]" MarkAsRead="False" OnlyUnreadMessages="True" Results="[o365m_Mails]" Top="1" />
                      <If Condition="[o365m_Mails.Count=0]" DisplayName="If: No email, next iteration" sap:VirtualizedContainerService.HintSize="549,246" sap2010:WorkflowViewState.IdRef="If_7">
                        <If.Then>
                          <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_1" />
                        </If.Then>
                      </If>
                      <If Condition="[o365m_Mails(0).Subject.Equals(&quot;NDA_Receiving_ValidateNDA_TC&quot; +in_int_TestCase.ToString)]" DisplayName="If: 1st email has the same subject -&gt; break, else next iteration" sap:VirtualizedContainerService.HintSize="549,371" sap2010:WorkflowViewState.IdRef="If_8">
                        <If.Then>
                          <Sequence DisplayName="Sequence: o365m_ProcessingMail" sap:VirtualizedContainerService.HintSize="304,214" sap2010:WorkflowViewState.IdRef="Sequence_18">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign DisplayName="Assign: o365m_ProcessingMail" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                              <Assign.To>
                                <OutArgument x:TypeArguments="umm:Office365Message">[o365m_ProcessingMail]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="umm:Office365Message">[o365m_Mails(0)]</InArgument>
                              </Assign.Value>
                            </Assign>
                            <ui:Break sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Break_2" />
                          </Sequence>
                        </If.Then>
                        <If.Else>
                          <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_2" />
                        </If.Else>
                      </If>
                    </Sequence>
                  </ui:InterruptibleWhile.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InterruptibleWhile>
                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="627,91" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Email sent and moved to folder: &quot; +str_ProcessingFolder+ &quot;.&quot;]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:LogMessage>
              </Sequence>
              <Sequence DisplayName="Sequence: Files in SharePoint" sap:VirtualizedContainerService.HintSize="755,1077" sap2010:WorkflowViewState.IdRef="Sequence_20">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign DisplayName="Assign: str_PDFPath" sap:VirtualizedContainerService.HintSize="520,60" sap2010:WorkflowViewState.IdRef="Assign_14">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[str_PDFPath]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">["Data\Temp\placeholder.txt"]</InArgument>
                  </Assign.Value>
                </Assign>
                <umaf:FindFilesAndFolders DriveName="{x:Null}" First="{x:Null}" Query="{x:Null}" sap2010:Annotation.AnnotationText="Fetch drive items of all the folders within in_str_SPRootFolder" DisplayName="Find Files And Folders: str_SPRootFolder" sap:VirtualizedContainerService.HintSize="520,126" sap2010:WorkflowViewState.IdRef="FindFilesAndFolders_1" Results="[di_SubFolders]" SiteUrl="[str_SPSite]" Subfolder="[str_SPRootFolder]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </umaf:FindFilesAndFolders>
                <ui:ForEach x:TypeArguments="mg:DriveItem" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Find subfolder - 01.Validate and upload the PDF attachment." DisplayName="For Each: Subfolder in di_SubFolders" sap:VirtualizedContainerService.HintSize="520,719" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[di_SubFolders]">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="mg:DriveItem">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="mg:DriveItem" Name="di_SubFolder" />
                      </ActivityAction.Argument>
                      <If Condition="[di_SubFolder.Name=str_SPValidateFolder]" DisplayName="If: di_SubFolder.Name=&quot;01.Validate&quot;" sap:VirtualizedContainerService.HintSize="484,555" sap2010:WorkflowViewState.IdRef="If_13">
                        <If.Then>
                          <Sequence DisplayName="Sequence: Upload file and break loop" sap:VirtualizedContainerService.HintSize="376,369" sap2010:WorkflowViewState.IdRef="Sequence_21">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_13" Level="Info" Message="[&quot;==ValidateNDA_TestCase== &quot; +str_SPValidateFolder+ &quot; subfolder present in root folder: &quot; +str_SPRootFolder+ &quot;.&quot;]">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:LogMessage>
                            <umaf:UploadFile Metadata="{x:Null}" CloudFileName="[&quot;NDA_Receiving_ValidateNDA_TC&quot;+in_int_TestCase.ToString+&quot;.pdf&quot;]" ConflictBehavior="Replace" Destination="[di_SubFolder]" DisplayName="Upload File: Attachement to 01.Validate" sap:VirtualizedContainerService.HintSize="334,84" sap2010:WorkflowViewState.IdRef="UploadFile_1" LocalFilePath="[str_PDFPath]" Result="[di_Attachment]" />
                            <ui:Break DisplayName="Break: loop" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Break_3" />
                          </Sequence>
                        </If.Then>
                      </If>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </Sequence>
              <If Condition="[in_bln_Approved And Not in_str_TestScenario.Contains(&quot;SE thrown for incorrect SPListSite&quot;) And Not in_str_TestScenario.Contains(&quot;BE thrown for no row found in SP List.&quot;) And Not in_str_TestScenario.Contains(&quot;SE thrown for incorrect SPIndNDARegList.&quot;) And Not in_str_TestScenario.Contains(&quot;SE thrown for incorrect EmailAddress/FullName Value/Field.&quot;)]" DisplayName="If: in_bln_Approved, add SharePoint List" sap:VirtualizedContainerService.HintSize="755,1106" sap2010:WorkflowViewState.IdRef="If_17">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence DisplayName="Sequence: SharePoint List" sap:VirtualizedContainerService.HintSize="376,920" sap2010:WorkflowViewState.IdRef="Sequence_22">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <umas:GetListInfo sap2010:Annotation.AnnotationText="Get list info:&#xA;in_str_SPIndNDARegList&#xA;&#xA;Assign to:&#xA;o365SPL_IndNDAReg" DisplayName="Get List Info: in_str_SPIndNDARegList" sap:VirtualizedContainerService.HintSize="334,271" sap2010:WorkflowViewState.IdRef="GetListInfo_1" IncludeColumnsDefinitions="True" List="[o365SPL_IndNDAReg]" ListTitleOrId="[in_str_SPIndNDARegList]" SiteUrlOrId="[in_str_SPListSite]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </umas:GetListInfo>
                    <ui:BuildDataTable DataTable="[dt_NDARegister]" DisplayName="Build Data Table : Individual NDA Register" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Full_x0020_Name&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Status&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Expiry&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Date_x0020_Executed&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Company&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Email_x0020_Address&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Employee_x0020_ID&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                    <ui:AddDataRow DataRow="{x:Null}" sap2010:Annotation.AnnotationText="Add Data Row : Individual NDA Register - Headers" ArrayRow="[{&quot;Title&quot;,&quot;Status&quot;,&quot;Expiry&quot;,&quot;Date Executed&quot;,&quot;Company&quot;,&quot;Email Address&quot;,&quot;Employee ID&quot;}]" DataTable="[dt_NDARegister]" DisplayName="Add Data Row : Individual NDA Register - Headers" sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="AddDataRow_1">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:AddDataRow>
                    <ui:AddDataRow DataRow="{x:Null}" sap2010:Annotation.AnnotationText="Add Data Row : Individual NDA Register - Values" ArrayRow="[{in_str_FullName,&quot;Issued&quot;,&quot;Evaluate termination date&quot;,DateTime.ParseExact(&quot;01/02/1990&quot;,&quot;dd/MM/yyyy&quot;,System.Globalization.CultureInfo.InvariantCulture),&quot;abc&quot;,in_str_EmailAddress,&quot;123&quot;}]" DataTable="[dt_NDARegister]" DisplayName="Add Data Row : Individual NDA Register - Values" sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="AddDataRow_2">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:AddDataRow>
                    <umas:AddListItems SingleListItem="{x:Null}" DisplayName="Add List Items: o365SPL_IndNDAReg" sap:VirtualizedContainerService.HintSize="334,210" sap2010:WorkflowViewState.IdRef="AddListItems_1" List="[o365SPL_IndNDAReg]" ListItems="[o365SPLI_ListItems]" MultipleListItems="[dt_NDARegister]" />
                  </Sequence>
                </If.Then>
                <If.Else>
                  <Sequence sap2010:WorkflowViewState.IdRef="Sequence_32">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </Sequence>
                </If.Else>
              </If>
              <Sequence DisplayName="Sequence: Add Transaction Item: Email Attributes" sap:VirtualizedContainerService.HintSize="755,271" sap2010:WorkflowViewState.IdRef="Sequence_33">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign DisplayName="Assign: str_TranRef" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_12">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[str_TranRef]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[o365m_ProcessingMail.Subject+"_"+DateTime.Now.ToString("yyyyMMddHHmmss")]</InArgument>
                  </Assign.Value>
                </Assign>
                <ui:AddTransactionItem ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Queue: in_str_QueueName&#xA;&#xA;Ref: str_TranRef" DisplayName="Add Transaction Item: Email Attributes" sap:VirtualizedContainerService.HintSize="262,79" sap2010:WorkflowViewState.IdRef="AddTransactionItem_1" QueueType="[str_QueueName]" Reference="[str_TranRef]" TransactionItem="[qi_TransactionItem]">
                  <ui:AddTransactionItem.TransactionInformation>
                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                  </ui:AddTransactionItem.TransactionInformation>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:AddTransactionItem>
              </Sequence>
              <Sequence DisplayName="Sequence: Determine SP and Mail Folders" sap:VirtualizedContainerService.HintSize="755,1213" sap2010:WorkflowViewState.IdRef="Sequence_34">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If Condition="[in_bln_Approved]" DisplayName="If: in_bln_Approved" sap:VirtualizedContainerService.HintSize="713,343" sap2010:WorkflowViewState.IdRef="If_18">
                  <If.Then>
                    <ui:MultipleAssign sap2010:Annotation.AnnotationText="Assign approved SP and Mail folders to:&#xA;str_SPSubFolder&#xA;str_MailSubFolder" DisplayName="Multiple Assign: Approved folder - SP &amp; Mail + AHT" sap:VirtualizedContainerService.HintSize="334,186" sap2010:WorkflowViewState.IdRef="MultipleAssign_5">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_17">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_SPSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[in_str_SPApprovedFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_18">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_MailSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[in_str_ApprovedFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:MultipleAssign>
                  </If.Then>
                  <If.Else>
                    <ui:MultipleAssign sap2010:Annotation.AnnotationText="Assign rejected SP and Mail folders to:&#xA;str_SPSubFolder&#xA;str_MailSubFolder" DisplayName="Multiple Assign: Approved folder - SP &amp; Mail + AHT" sap:VirtualizedContainerService.HintSize="334,186" sap2010:WorkflowViewState.IdRef="MultipleAssign_6">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_19">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_SPSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[in_str_SPRejectedFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_20">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_MailSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[in_str_RejectedFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:MultipleAssign>
                  </If.Else>
                </If>
                <If Condition="[in_str_TestScenario.Contains(&quot;SE thrown for incorrect MailSubFolder.&quot;)]" DisplayName="If: SE thrown for incorrect MailSubFolder." sap:VirtualizedContainerService.HintSize="713,372" sap2010:WorkflowViewState.IdRef="If_19">
                  <If.Then>
                    <ui:MultipleAssign sap2010:Annotation.AnnotationText="Assign approved SP and Mail folders to:&#xA;str_SPSubFolder&#xA;str_MailSubFolder" DisplayName="Multiple Assign: Approved folder - SP &amp; Mail + AHT" sap:VirtualizedContainerService.HintSize="334,186" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_21">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_SPSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[str_SPValidateFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_22">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_MailSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[str_ProcessingFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:MultipleAssign>
                  </If.Then>
                </If>
                <If Condition="[in_str_TestScenario.Contains(&quot;SE thrown for incorrect SPSubFolder.&quot;) Or in_str_TestScenario.Contains(&quot;SE thrown for incorrect StorageBucket.&quot;)]" DisplayName="If: SE thrown for incorrect MailSubFolder." sap:VirtualizedContainerService.HintSize="713,326" sap2010:WorkflowViewState.IdRef="If_20">
                  <If.Then>
                    <ui:MultipleAssign sap2010:Annotation.AnnotationText="Assign approved SP and Mail folders to:&#xA;str_SPSubFolder" DisplayName="Multiple Assign: Approved folder - SP &amp; Mail + AHT" sap:VirtualizedContainerService.HintSize="334,140" sap2010:WorkflowViewState.IdRef="MultipleAssign_9">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_25">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[str_SPSubFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[str_SPValidateFolder]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:MultipleAssign>
                  </If.Then>
                </If>
              </Sequence>
            </Sequence>
          </ActivityAction>
        </uma:Office365ApplicationScope.Body>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </uma:Office365ApplicationScope>
    </Sequence>
    <Sequence DisplayName="... When" sap:VirtualizedContainerService.HintSize="1197,643" sap2010:WorkflowViewState.IdRef="Sequence_3">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438,551" sap2010:WorkflowViewState.IdRef="TryCatch_1">
        <TryCatch.Try>
          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke ValidateNDA workflow" sap:VirtualizedContainerService.HintSize="376,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="CustomWorkflows\ValidateNDA\ValidateNDA.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_Pg6StoragePath">[str_Pg6StoragePath]</InArgument>
              <InArgument x:TypeArguments="mg:DriveItem" x:Key="in_di_Attachment">[di_Attachment]</InArgument>
              <InArgument x:TypeArguments="mg:DriveItem[]" x:Key="in_di_SubFolders">[di_SubFolders]</InArgument>
              <InArgument x:TypeArguments="umm:Office365Message" x:Key="in_o365m_ProcessingMail">[o365m_ProcessingMail]</InArgument>
              <InArgument x:TypeArguments="ui:QueueItem" x:Key="in_qi_TransactionItem">[qi_TransactionItem]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_Pg2StoragePath">[str_Pg2StoragePath]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_StorageBucket">[in_str_StorageBucket]</InArgument>
              <InArgument x:TypeArguments="ss:SecureString" x:Key="in_sstr_Password">[sstr_Password]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_TenantId">[str_TenantId]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_ApplicationId">[str_ApplicationId]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_Username">[str_Username]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_SPApprovedFolder">[in_str_SPApprovedFolder]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_SPRejectedFolder">[in_str_SPRejectedFolder]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_Account">[in_str_Account]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_ApprovedFolder">[in_str_ApprovedFolder]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_RejectedFolder">[in_str_RejectedFolder]</InArgument>
              <InArgument x:TypeArguments="x:Double" x:Key="in_dbl_ApprovedAHT">[in_dbl_ApprovedAHT]</InArgument>
              <InArgument x:TypeArguments="x:Double" x:Key="in_dbl_RejectedAHT">[in_dbl_RejectedAHT]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_SPIndNDARegList">[in_str_SPIndNDARegList]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_SPListSite">[in_str_SPListSite]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_FullNameField">[in_str_FullNameField]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_EmailAddressField">[in_str_EmailAddressField]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_FFITeamEmail">[in_str_FFITeamEmail]</InArgument>
              <InArgument x:TypeArguments="x:Boolean" x:Key="in_bln_Approved">[in_bln_Approved]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_FullName">[in_str_FullName]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_EmailAddress">[in_str_EmailAddress]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="in_str_StatusField">[in_str_StatusField]</InArgument>
              <InArgument x:TypeArguments="s:DateTime" x:Key="in_dati_ExeutedDate">[dati_ExeutedDate]</InArgument>
              <InArgument x:TypeArguments="x:Double" x:Key="in_dbl_BizExpAHT">5</InArgument>
            </ui:InvokeWorkflowFile.Arguments>
          </ui:InvokeWorkflowFile>
        </TryCatch.Try>
        <TryCatch.Catches>
          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,129" sap2010:WorkflowViewState.IdRef="Catch`1_1">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ActivityAction x:TypeArguments="s:Exception">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
              </ActivityAction.Argument>
              <Assign DisplayName="Assign: SE" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_11">
                <Assign.To>
                  <OutArgument x:TypeArguments="s:Exception">[exc_Exception]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                </Assign.Value>
              </Assign>
            </ActivityAction>
          </Catch>
        </TryCatch.Catches>
      </TryCatch>
    </Sequence>
    <Sequence DisplayName="... Then" sap:VirtualizedContainerService.HintSize="1197,1296" sap2010:WorkflowViewState.IdRef="Sequence_4">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1155,91" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Verify results.&quot;]" />
      <If Condition="[exc_Exception is Nothing]" DisplayName="If: exception is nothing" sap:VirtualizedContainerService.HintSize="1155,311" sap2010:WorkflowViewState.IdRef="If_12">
        <If.Then>
          <Sequence DisplayName="Sequence: Successful verify" sap:VirtualizedContainerService.HintSize="576,153" sap2010:WorkflowViewState.IdRef="Sequence_14">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <uta:VerifyExpression AlternativeVerificationTitle="{x:Null}" KeepScreenshots="{x:Null}" OutputMessageFormat="{x:Null}" Result="{x:Null}" ScreenshotsPath="{x:Null}" ContinueOnFailure="True" DisplayName="Verify Expression" Expression="[qi_TransactionItem.Status.ToString=&quot;Successful&quot;]" sap:VirtualizedContainerService.HintSize="534,61" sap2010:WorkflowViewState.IdRef="VerifyExpression_1" TakeScreenshotInCaseOfFailingAssertion="False" TakeScreenshotInCaseOfSucceedingAssertion="False" />
          </Sequence>
        </If.Then>
        <If.Else>
          <uta:VerifyExpressionWithOperator AlternativeVerificationTitle="{x:Null}" KeepScreenshots="{x:Null}" OutputMessageFormat="{x:Null}" Result="{x:Null}" ScreenshotsPath="{x:Null}" ContinueOnFailure="True" DisplayName="Verify Expression with Operator" sap:VirtualizedContainerService.HintSize="534,61" sap2010:WorkflowViewState.IdRef="VerifyExpressionWithOperator_2" Operator="Contains" TakeScreenshotInCaseOfFailingAssertion="False" TakeScreenshotInCaseOfSucceedingAssertion="False">
            <uta:VerifyExpressionWithOperator.FirstExpression>
              <InArgument x:TypeArguments="x:String">[exc_Exception.Message]</InArgument>
            </uta:VerifyExpressionWithOperator.FirstExpression>
            <uta:VerifyExpressionWithOperator.SecondExpression>
              <InArgument x:TypeArguments="x:String">[in_str_TestResult]</InArgument>
            </uta:VerifyExpressionWithOperator.SecondExpression>
          </uta:VerifyExpressionWithOperator>
        </If.Else>
      </If>
      <uma:Office365ApplicationScope ApplicationSecret="{x:Null}" CertificateAsBase64="{x:Null}" CertificatePassword="{x:Null}" ContinueOnError="{x:Null}" Password="{x:Null}" SecureApplicationSecret="{x:Null}" ApplicationId="[str_ApplicationId]" AuthenticationType="UsernameAndPassword" DisplayName="Microsoft Office 365 Scope: Mail, file, List" Environment="Global" sap:VirtualizedContainerService.HintSize="1155,722" sap2010:WorkflowViewState.IdRef="Office365ApplicationScope_3" OAuthApplication="Custom" SecurePassword="[sstr_Password]" Services="Mail" Tenant="[str_TenantId]" Timeout="300000" Username="[str_Username]">
        <uma:Office365ApplicationScope.Body>
          <ActivityAction x:TypeArguments="mg:GraphServiceClient">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="mg:GraphServiceClient" Name="ParentScope" />
            </ActivityAction.Argument>
            <Flowchart DisplayName="Flowchart: Delete Mail, file, List" sap:VirtualizedContainerService.HintSize="644,636" sap2010:WorkflowViewState.IdRef="Flowchart_4">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
                  <x:Double x:Key="Width">610</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID4</x:Reference>
              </Flowchart.StartNode>
              <FlowDecision x:Name="__ReferenceID4" Condition="[in_bln_Approved And Not in_str_TestScenario.Contains(&quot;SE thrown for incorrect SPListSite&quot;) And Not in_str_TestScenario.Contains(&quot;BE thrown for no row found in SP List.&quot;) And Not in_str_TestScenario.Contains(&quot;SE thrown for incorrect SPIndNDARegList.&quot;) And Not in_str_TestScenario.Contains(&quot;SE thrown for incorrect EmailAddress/FullName Value/Field.&quot;)]" DisplayName="FD: in_bln_Approved?" sap:VirtualizedContainerService.HintSize="120,87" sap2010:WorkflowViewState.IdRef="FlowDecision_7">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <av:Point x:Key="ShapeLocation">240,127.5</av:Point>
                    <av:Size x:Key="ShapeSize">120,87</av:Size>
                    <av:PointCollection x:Key="TrueConnector">240,171 200,171</av:PointCollection>
                    <av:PointCollection x:Key="FalseConnector">360,171 410,171</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <FlowDecision.True>
                  <FlowStep x:Name="__ReferenceID1">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">0,64.5</av:Point>
                        <av:Size x:Key="ShapeSize">200,213</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">100,277.5 100,291 380,291 380,171 410,171</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <umas:ForEachListItem CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Filter o365SPL_IndNDAReg based on:&#xA;- Full Name&#xA;- Email Address&#xA;&#xA;Assign cell values of:&#xA;- Status&#xA;- Executed Date&#xA;&#xA;Delete the row." DisplayName="For Each List Item: in 0365SPL_IndNDAReg" Filter="[&quot;(fields/&quot; +in_str_FullNameField+ &quot; eq '&quot; +in_str_FullName+ &quot;') and (fields/&quot; +in_str_EmailAddressField+ &quot; eq '&quot; +in_str_EmailAddress+ &quot;')&quot;]" sap:VirtualizedContainerService.HintSize="200,213" sap2010:WorkflowViewState.IdRef="ForEachListItem_3" List="[o365SPL_IndNDAReg]">
                      <umas:ForEachListItem.Body>
                        <ActivityAction x:TypeArguments="umm:Office365SharepointListItem, x:Int32">
                          <ActivityAction.Argument1>
                            <DelegateInArgument x:TypeArguments="umm:Office365SharepointListItem" Name="li_IndNDAReg" />
                          </ActivityAction.Argument1>
                          <ActivityAction.Argument2>
                            <DelegateInArgument x:TypeArguments="x:Int32" Name="ListItemIndex" />
                          </ActivityAction.Argument2>
                          <Sequence sap:VirtualizedContainerService.HintSize="376,311" sap2010:WorkflowViewState.IdRef="Sequence_36">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <umas:DeleteListItem DisplayName="Delete List Item: li_IndNDAReg" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="DeleteListItem_3" ListItem="[li_IndNDAReg]" />
                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_18" Level="Info" Message="[&quot;==ValidateNDA== List item deleted.&quot;]" />
                          </Sequence>
                        </ActivityAction>
                      </umas:ForEachListItem.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </umas:ForEachListItem>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID0">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">410,124.5</av:Point>
                            <av:Size x:Key="ShapeSize">200,93</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">510,217.5 510,267.5</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InterruptibleWhile sap2010:Annotation.AnnotationText="Find matching mail and delete." Condition="[1=1]" DisplayName="While: Loop till Mail found in str_MailSubFolder" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_3">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Body: Get Mail" sap:VirtualizedContainerService.HintSize="663,966" sap2010:WorkflowViewState.IdRef="Sequence_38">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <umam:GetMail Query="{x:Null}" Account="[in_str_Account]" DisplayName="Get Mail: str_MailSubFolder" GetAsHTML="False" sap:VirtualizedContainerService.HintSize="621,22" sap2010:WorkflowViewState.IdRef="GetMail_5" MailFolder="[str_MailSubFolder]" MarkAsRead="False" OnlyUnreadMessages="False" Results="[o365m_Mails]" Top="1" />
                              <If Condition="[o365m_Mails.Count=0]" DisplayName="If: No email, next iteration" sap:VirtualizedContainerService.HintSize="621,246" sap2010:WorkflowViewState.IdRef="If_21">
                                <If.Then>
                                  <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_5" />
                                </If.Then>
                              </If>
                              <If Condition="[o365m_Mails(0).Subject.Equals(&quot;NDA_Receiving_ValidateNDA_TC&quot; +in_int_TestCase.ToString)]" DisplayName="If: 1st email has the same subject -&gt; break, else next iteration" sap:VirtualizedContainerService.HintSize="621,526" sap2010:WorkflowViewState.IdRef="If_22">
                                <If.Then>
                                  <Sequence DisplayName="Sequence: Delete Mail o365m_Mails(0)" sap:VirtualizedContainerService.HintSize="376,369" sap2010:WorkflowViewState.IdRef="Sequence_37">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <umam:DeleteMail Account="[in_str_Account]" DisplayName="Delete Mail: o365m_Mails(0)" sap:VirtualizedContainerService.HintSize="334,84" sap2010:WorkflowViewState.IdRef="DeleteMail_6" Message="[o365m_Mails(0)]" PermanentlyDelete="False" />
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_19" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Mail deleted from folder: &quot; +str_MailSubFolder+ &quot;.&quot;]" />
                                    <ui:Break sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Break_7" />
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_6" />
                                </If.Else>
                              </If>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                        <FlowStep.Next>
                          <FlowStep x:Name="__ReferenceID3">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <av:Point x:Key="ShapeLocation">410,267.5</av:Point>
                                <av:Size x:Key="ShapeSize">200,93</av:Size>
                                <av:PointCollection x:Key="ConnectorLocation">510,360.5 510,410.5</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <umaf:FindFilesAndFolders DriveName="{x:Null}" First="{x:Null}" Query="{x:Null}" sap2010:Annotation.AnnotationText="str_SPRootFolder+&quot;/&quot;+str_SPSubFolder" DisplayName="Find Files And Folders: str_SPRootFolder+&quot;/&quot;+str_SPSubFolder" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="FindFilesAndFolders_5" Results="[di_Files]" SiteUrl="[str_SPSite]" Subfolder="[str_SPRootFolder+&quot;/&quot;+str_SPSubFolder]">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </umaf:FindFilesAndFolders>
                            <FlowStep.Next>
                              <FlowStep x:Name="__ReferenceID2">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">410,410.5</av:Point>
                                    <av:Size x:Key="ShapeSize">200,108</av:Size>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:ForEach x:TypeArguments="mg:DriveItem" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Find File - in_str_FullName+ &quot; Confidentiality Deed Poll.pdf&quot; and delete." DisplayName="For Each: File in di_Files" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[di_Files]">
                                  <ui:ForEach.Body>
                                    <ActivityAction x:TypeArguments="mg:DriveItem">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="mg:DriveItem" Name="di_File" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="Sequence: Delete Item: di_File" sap:VirtualizedContainerService.HintSize="376,238" sap2010:WorkflowViewState.IdRef="Sequence_39">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <umaf:DeleteItem DisplayName="Delete Item: di_File" DriveItem="[di_File]" sap:VirtualizedContainerService.HintSize="334,84" sap2010:WorkflowViewState.IdRef="DeleteItem_7" />
                                        <ui:Break sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Break_8" />
                                      </Sequence>
                                    </ActivityAction>
                                  </ui:ForEach.Body>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:ForEach>
                              </FlowStep>
                            </FlowStep.Next>
                          </FlowStep>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowDecision.True>
                <FlowDecision.False>
                  <x:Reference>__ReferenceID0</x:Reference>
                </FlowDecision.False>
              </FlowDecision>
              <x:Reference>__ReferenceID1</x:Reference>
              <x:Reference>__ReferenceID0</x:Reference>
              <x:Reference>__ReferenceID2</x:Reference>
              <x:Reference>__ReferenceID3</x:Reference>
            </Flowchart>
          </ActivityAction>
        </uma:Office365ApplicationScope.Body>
      </uma:Office365ApplicationScope>
    </Sequence>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1197,91" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;==ValidateNDA_TestCase== Completed.&quot;]" />
  </Sequence>
</Activity>