<Activity mc:Ignorable="sap sap2010" x:Class="FetchEmail" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mg="clr-namespace:Microsoft.Graph;assembly=Microsoft.Graph" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:ss="clr-namespace:System.Security;assembly=mscorlib" xmlns:ucas="clr-namespace:UiPath.Core.Activities.Storage;assembly=UiPath.System.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uma="clr-namespace:UiPath.MicrosoftOffice365.Activities;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umaf="clr-namespace:UiPath.MicrosoftOffice365.Activities.Files;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umam="clr-namespace:UiPath.MicrosoftOffice365.Activities.Mail;assembly=UiPath.MicrosoftOffice365.Activities" xmlns:umm="clr-namespace:UiPath.MicrosoftOffice365.Models;assembly=UiPath.MicrosoftOffice365" xmlns:upap="clr-namespace:UiPath.PDF.Activities.PDF;assembly=UiPath.PDF.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_str_ApplicationId" Type="InArgument(x:String)" />
    <x:Property Name="in_str_TenantId" Type="InArgument(x:String)" />
    <x:Property Name="in_str_Username" Type="InArgument(x:String)" />
    <x:Property Name="in_sstr_Password" Type="InArgument(ss:SecureString)" />
    <x:Property Name="in_str_Account" Type="InArgument(x:String)" />
    <x:Property Name="in_str_MailFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_ProcessingFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_QueueName" Type="InArgument(x:String)" />
    <x:Property Name="out_qi_TransactionItem" Type="OutArgument(ui:QueueItem)" />
    <x:Property Name="out_o365m_ProcessingMail" Type="OutArgument(umm:Office365Message)" />
    <x:Property Name="in_str_StorageBucket" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPSite" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPRootFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_str_SPValidateFolder" Type="InArgument(x:String)" />
    <x:Property Name="out_di_Attachment" Type="OutArgument(mg:DriveItem)" />
    <x:Property Name="out_di_SubFolders" Type="OutArgument(mg:DriveItem[])" />
    <x:Property Name="out_str_Pg2StoragePath" Type="OutArgument(x:String)" />
    <x:Property Name="out_str_Pg6StoragePath" Type="OutArgument(x:String)" />
    <x:Property Name="in_str_RejectedFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_dbl_AHT" Type="InArgument(x:Double)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1490,11055</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>FetchEmail_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="45">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>Microsoft.Graph</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.MicrosoftOffice365.Enums</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>UiPath.MicrosoftOffice365.Models</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>UiPath.Persistence.Activities.Model.Task</x:String>
      <x:String>UiPath.Persistence.Activities.FormTask</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Files</x:String>
      <x:String>UiPath.DocumentUnderstanding.Digitizer.Utils</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.PDF.Activities.PDF</x:String>
      <x:String>UiPath.PDF.Activities</x:String>
      <x:String>UiPath.Core.Activities.Storage</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="39">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.Graph</AssemblyReference>
      <AssemblyReference>Microsoft.Graph.Core</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Persistence.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>UiPath.DocumentUnderstanding.Digitizer</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Sequence sap2010:Annotation.AnnotationText="Description: Fetch an email with PDF as an attachment, upload the PDF to SharePoint and an image of Pg2. and Pg6. to StorageLibrary.&#xA;&#xA;Arguments:&#xA;in_str_ApplicationId - Applicant ID for o365.&#xA;in_str_TenantId - Tenant ID for o365.&#xA;in_str_Username - AD Username for o365.&#xA;in_sstr_Password - Password (SecureString) for o365.&#xA;in_str_Account - Mail account to perform mail operations.&#xA;in_str_MailFolder - Mail folder to fetch the emails from.&#xA;in_str_ProcessingFolder - Mail folder to place the processing mail.&#xA;in_str_RejectedFolder - Mail folder to place/move the invalid/no attachment mail.&#xA;in_str_SPSite - SharePoint site to perform file operations.&#xA;in_str_SPRootFolder - SharePoint Root folders.&#xA;in_str_SPValidateFolder - Validate (subfolder) within root folder.&#xA;in_str_StorageBucket - Orchestrator storage bucket to store and retreive Pg2 and Pg6 img.&#xA;in_str_QueueName - Process specific queue name.&#xA;in_dbl_AHT - Biz. Exp. AHT.&#xA;out_qi_TransactionItem - Out arg. to strore the added Queue/Transaction item.&#xA;out_o365m_ProcessingMail - Out arg. to store the email retreived from Processing folder.&#xA;out_di_SubFolders - Drive item list that stores the information of Subfolder within the root folder.&#xA;out_di_Attachment - Drive item that store the information of the PDF file uploded to Validate folder.&#xA;out_str_Pg2StoragePath - Storage bucket path where Pg2 img. is uploaded.&#xA;out_str_Pg6StoragePath - Storage bucket path where Pg2 img. is uploaded.&#xA;&#xA;Outcomes:&#xA;Successful - Valid - A PDF retrieved from email, PDF uploaded to SharePoint, Pg2 and Pg6 img uploaded to storage buckets.&#xA;Unsuccessful - out_qi_TransactionItem = NULL, out_di_SubFolders = NULL, out_di_Attachment = NULL, out_str_Pg2StoragePath = &quot;&quot;, out_str_Pg6StoragePath = &quot;&quot;, with exception thrown detailing the error that occurred." DisplayName="FetchEmail" sap:VirtualizedContainerService.HintSize="988,10990" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="umm:Office365Message[]" Name="o365m_Mails" />
      <Variable x:TypeArguments="snm:MailAddress" Name="ma_RMailSender" />
      <Variable x:TypeArguments="x:String" Name="str_RMailSubject" />
      <Variable x:TypeArguments="s:DateTime" Name="dati_RMailTimeStamp" />
      <Variable x:TypeArguments="x:Boolean" Name="bln_AttachFolderExists" />
      <Variable x:TypeArguments="scg:IEnumerable(x:String)" Name="iEnum_Attachments" />
      <Variable x:TypeArguments="x:String" Name="str_LocalAttachPath" />
      <Variable x:TypeArguments="x:String" Name="str_PMailAddress" />
      <Variable x:TypeArguments="x:String" Name="str_PMailId" />
      <Variable x:TypeArguments="x:String" Name="str_PMailSubject" />
      <Variable x:TypeArguments="x:String" Name="str_PMailTimeStamp" />
      <Variable x:TypeArguments="x:String" Name="str_TranRef" />
      <Variable x:TypeArguments="s:Exception" Name="exp_Exception" />
      <Variable x:TypeArguments="x:String" Name="str_MailMoveFolder" />
      <Variable x:TypeArguments="x:Int32" Name="int_PDFPgCount" />
      <Variable x:TypeArguments="x:Boolean" Name="bln_ImgUploaded" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="946,91" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[&quot;==FetchEmail== Started.&quot;]">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:LogMessage>
    <uma:Office365ApplicationScope ApplicationSecret="{x:Null}" CertificateAsBase64="{x:Null}" CertificatePassword="{x:Null}" ContinueOnError="{x:Null}" Password="{x:Null}" SecureApplicationSecret="{x:Null}" ApplicationId="[in_str_ApplicationId]" AuthenticationType="UsernameAndPassword" DisplayName="Microsoft Office 365 Scope: Email, File operations" Environment="Global" sap:VirtualizedContainerService.HintSize="946,10335" sap2010:WorkflowViewState.IdRef="Office365ApplicationScope_1" OAuthApplication="Custom" SecurePassword="[in_sstr_Password]" Services="Files, Mail" Tenant="[in_str_TenantId]" Timeout="300000" Username="[in_str_Username]">
      <uma:Office365ApplicationScope.Body>
        <ActivityAction x:TypeArguments="mg:GraphServiceClient">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="mg:GraphServiceClient" Name="ParentScope" />
          </ActivityAction.Argument>
          <TryCatch DisplayName="Try Catch: Read mail, retrive attachment, upload to SharePoint and upload pg2 and pg6 as an image to Storage Bucket" sap:VirtualizedContainerService.HintSize="912,10249" sap2010:WorkflowViewState.IdRef="TryCatch_1">
            <TryCatch.Try>
              <Flowchart DisplayName="Flowchart: Read mail, retrive attachment, upload to SharePoint and upload pg2 and pg6 as an image to Storage Bucket" sap:VirtualizedContainerService.HintSize="874,3620" sap2010:WorkflowViewState.IdRef="Flowchart_2">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <av:Point x:Key="ShapeLocation">360,2.5</av:Point>
                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">390,77.5 390,127.5</av:PointCollection>
                    <x:Double x:Key="Height">3583.5</x:Double>
                    <x:Double x:Key="Width">840</x:Double>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Flowchart.StartNode>
                  <x:Reference>__ReferenceID49</x:Reference>
                </Flowchart.StartNode>
                <FlowStep x:Name="__ReferenceID3">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">290,771.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">390,822.5 390,877.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;==FetchEmail== &quot; +o365m_Mails.Count.ToString+ &quot; email retrieved from folder: &quot; +in_str_MailFolder+ &quot;.&quot;]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:LogMessage>
                  <FlowStep.Next>
                    <FlowDecision x:Name="__ReferenceID5" sap2010:Annotation.AnnotationText="o365m_Mails.Count=0" Condition="[o365m_Mails.Count=0]" DisplayName="FD: No emails to process?" sap:VirtualizedContainerService.HintSize="155,129" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <av:Point x:Key="ShapeLocation">312.5,877.5</av:Point>
                          <av:Size x:Key="ShapeSize">155,129</av:Size>
                          <av:PointCollection x:Key="TrueConnector">312.5,942 250,942</av:PointCollection>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          <av:PointCollection x:Key="FalseConnector">467.5,942 537.5,942</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <FlowDecision.True>
                        <FlowStep x:Name="__ReferenceID6">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">50,916.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">310,477.5 310,507.5 310.141666666667,507.5 310.141666666667,527.5</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;==FetchEmail== No more emails in folder: &quot; +in_str_MailFolder+ &quot;.&quot;]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                        </FlowStep>
                      </FlowDecision.True>
                      <FlowDecision.False>
                        <FlowStep x:Name="__ReferenceID7">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">537.5,873</av:Point>
                              <av:Size x:Key="ShapeSize">200,138</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">637.5,1011 637.5,1046</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:MultipleAssign sap2010:Annotation.AnnotationText="Root folder mail Attributes:&#xA;&#xA;dati_RMailTimeStamp&#xA;str_RMailSubject&#xA;ma_RMailSender" DisplayName="Multiple Assign: Email Attributes" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
                            <ui:MultipleAssign.AssignOperations>
                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="s:DateTime">[dati_RMailTimeStamp]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="s:DateTime">[Convert.ToDateTime(o365m_Mails(0).ReceivedDateTime)]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="x:String">[str_RMailSubject]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="x:String">[o365m_Mails(0).Subject]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="snm:MailAddress">[ma_RMailSender]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="snm:MailAddress">[o365m_Mails(0).Sender]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                              </scg:List>
                            </ui:MultipleAssign.AssignOperations>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:MultipleAssign>
                          <FlowStep.Next>
                            <FlowStep x:Name="__ReferenceID8">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">537.5,1046</av:Point>
                                  <av:Size x:Key="ShapeSize">200,153</av:Size>
                                  <av:PointCollection x:Key="ConnectorLocation">537.5,1122.5 487.5,1122.5</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <umam:MoveMail Account="[in_str_Account]" sap2010:Annotation.AnnotationText="Move email:&#xA;in_str_Account&#xA;o365m_Mails(0)&#xA;&#xA;To:&#xA;in_str_ProcessingFolder" DestinationFolderName="[in_str_ProcessingFolder]" DisplayName="Move Mail: in_str_ProcessingFolder" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="MoveMail_1" Message="[o365m_Mails(0)]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </umam:MoveMail>
                              <FlowStep.Next>
                                <FlowStep x:Name="__ReferenceID9">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">287.5,1060.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,124</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">287.5,1122.5 237.5,1122.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <umam:GetMail Query="{x:Null}" Account="[in_str_Account]" sap2010:Annotation.AnnotationText="Fetch first email:&#xA;in_strAccount&#xA; in_str_ProcessingFolder&#xA;&#xA;Store in:&#xA;o365m_Mails" DisplayName="Get Mail: in_str_ProcessingFolder" GetAsHTML="False" sap:VirtualizedContainerService.HintSize="200,124" sap2010:WorkflowViewState.IdRef="GetMail_4" MailFolder="[in_str_ProcessingFolder]" MarkAsRead="False" OnlyUnreadMessages="False" Results="[o365m_Mails]" Top="[Int32.MaxValue]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </umam:GetMail>
                                  <FlowStep.Next>
                                    <FlowStep x:Name="__ReferenceID15">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">37.5,1097</av:Point>
                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">137.5,1148 137.5,1198</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Info" Message="[&quot;==FetchEmail== Email moved to folder: &quot; +in_str_MailFolder+ &quot; and retrieved &quot; +o365m_Mails.Count.ToString+ &quot; (all available) emails.&quot;]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:LogMessage>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID10">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">37.5,1198</av:Point>
                                              <av:Size x:Key="ShapeSize">200,213</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">237.5,1304.5 287.5,1304.5</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:ForEach x:TypeArguments="umm:Office365Message" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Identify the email from in_str_ProcessingFolder that matches with the details fetched:&#xA;dati_EmailReceived&#xA;str_Subject&#xA;ma_Sender&#xA;&#xA;Store in:&#xA;o365m_ProcessingMail" DisplayName="For Each: Main in o365m_Mails" sap:VirtualizedContainerService.HintSize="200,213" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[o365m_Mails]">
                                            <ui:ForEach.Body>
                                              <ActivityAction x:TypeArguments="umm:Office365Message">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="umm:Office365Message" Name="o365m_Mail" />
                                                </ActivityAction.Argument>
                                                <If Condition="[o365m_Mail.ReceivedDateTime.Equals(dati_RMailTimeStamp) And o365m_Mail.Subject=str_RMailSubject And o365m_Mail.Sender.Equals(ma_RMailSender)]" DisplayName="If: o365m_Mail attributes = dati_EmailReceived, str_Subject, ma_Sender" sap:VirtualizedContainerService.HintSize="484,601" sap2010:WorkflowViewState.IdRef="If_1">
                                                  <If.Then>
                                                    <Sequence DisplayName="Sequence: Extract Mail and break the loop" sap:VirtualizedContainerService.HintSize="376,414" sap2010:WorkflowViewState.IdRef="Sequence_5">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:MultipleAssign sap2010:Annotation.AnnotationText="o365m_ProcessingMail" DisplayName="Multiple Assign: Processing email attribute" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_2">
                                                        <ui:MultipleAssign.AssignOperations>
                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                                                              <ui:AssignOperation.To>
                                                                <OutArgument x:TypeArguments="umm:Office365Message">[out_o365m_ProcessingMail]</OutArgument>
                                                              </ui:AssignOperation.To>
                                                              <ui:AssignOperation.Value>
                                                                <InArgument x:TypeArguments="umm:Office365Message">[o365m_Mail]</InArgument>
                                                              </ui:AssignOperation.Value>
                                                            </ui:AssignOperation>
                                                          </scg:List>
                                                        </ui:MultipleAssign.AssignOperations>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:MultipleAssign>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Info" Message="[&quot;==FetchEmail== Email retrieved from folder: &quot; +in_str_ProcessingFolder+ &quot;.&quot;]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:LogMessage>
                                                      <ui:Break DisplayName="Break: loop" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Break_1" />
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="200,83" sap2010:WorkflowViewState.IdRef="Sequence_6">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </ActivityAction>
                                            </ui:ForEach.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:ForEach>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID19">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">287.5,1228</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,153</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">487.5,1304.5 537.5,1304.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:MultipleAssign sap2010:Annotation.AnnotationText="str_PMailSubject&#xA;str_PMailId&#xA;str_PMailAddress&#xA;str_PMailTimeStamp&#xA;str_TranRef&#xA;str_LocalAttachPath" DisplayName="Multiple Assign: Assisgn variables" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="MultipleAssign_6">
                                                <ui:MultipleAssign.AssignOperations>
                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_24">
                                                      <ui:AssignOperation.To>
                                                        <OutArgument x:TypeArguments="x:String">[str_PMailSubject]</OutArgument>
                                                      </ui:AssignOperation.To>
                                                      <ui:AssignOperation.Value>
                                                        <InArgument x:TypeArguments="x:String">[out_o365m_ProcessingMail.Subject]</InArgument>
                                                      </ui:AssignOperation.Value>
                                                    </ui:AssignOperation>
                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_25">
                                                      <ui:AssignOperation.To>
                                                        <OutArgument x:TypeArguments="x:String">[str_PMailId]</OutArgument>
                                                      </ui:AssignOperation.To>
                                                      <ui:AssignOperation.Value>
                                                        <InArgument x:TypeArguments="x:String">[out_o365m_ProcessingMail.MessageId]</InArgument>
                                                      </ui:AssignOperation.Value>
                                                    </ui:AssignOperation>
                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_26">
                                                      <ui:AssignOperation.To>
                                                        <OutArgument x:TypeArguments="x:String">[str_PMailAddress]</OutArgument>
                                                      </ui:AssignOperation.To>
                                                      <ui:AssignOperation.Value>
                                                        <InArgument x:TypeArguments="x:String">[out_o365m_ProcessingMail.Sender.Address]</InArgument>
                                                      </ui:AssignOperation.Value>
                                                    </ui:AssignOperation>
                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_27">
                                                      <ui:AssignOperation.To>
                                                        <OutArgument x:TypeArguments="x:String">[str_PMailTimeStamp]</OutArgument>
                                                      </ui:AssignOperation.To>
                                                      <ui:AssignOperation.Value>
                                                        <InArgument x:TypeArguments="x:String">[out_o365m_ProcessingMail.ReceivedDateTime.ToString]</InArgument>
                                                      </ui:AssignOperation.Value>
                                                    </ui:AssignOperation>
                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_28">
                                                      <ui:AssignOperation.To>
                                                        <OutArgument x:TypeArguments="x:String">[str_TranRef]</OutArgument>
                                                      </ui:AssignOperation.To>
                                                      <ui:AssignOperation.Value>
                                                        <InArgument x:TypeArguments="x:String">[out_o365m_ProcessingMail.Subject+"_"+DateTime.Now.ToString("yyyyMMddHHmmss")]</InArgument>
                                                      </ui:AssignOperation.Value>
                                                    </ui:AssignOperation>
                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_29">
                                                      <ui:AssignOperation.To>
                                                        <OutArgument x:TypeArguments="x:String">[str_LocalAttachPath]</OutArgument>
                                                      </ui:AssignOperation.To>
                                                      <ui:AssignOperation.Value>
                                                        <InArgument x:TypeArguments="x:String">["Data\Temp\" +out_o365m_ProcessingMail.Sender.Address.Replace(".","_").Replace("@","_")+"_"+DateTime.Now.ToString("yyyyMMddHHmmss")]</InArgument>
                                                      </ui:AssignOperation.Value>
                                                    </ui:AssignOperation>
                                                  </scg:List>
                                                </ui:MultipleAssign.AssignOperations>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:MultipleAssign>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID45">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">537.5,1220</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,169</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">637.5,1389 637.5,1439</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddTransactionItem ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Queue: in_str_QueueName&#xA;&#xA;Ref: str_TranRef&#xA;&#xA;Transaction Info:&#xA;str_PMailSubject&#xA;str_PMailId&#xA;str_PMailAddress&#xA;str_PMailTimeStamp" DisplayName="Add Transaction Item: Email Attributes" sap:VirtualizedContainerService.HintSize="200,169" sap2010:WorkflowViewState.IdRef="AddTransactionItem_3" QueueType="[in_str_QueueName]" Reference="[str_TranRef]" TransactionItem="[out_qi_TransactionItem]">
                                                    <ui:AddTransactionItem.TransactionInformation>
                                                      <InArgument x:TypeArguments="x:String" x:Key="EmailSubject">[str_PMailSubject]</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="EmailID">[str_PMailId]</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="EmailDateTime">[str_PMailTimeStamp]</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="EmailSender">[str_PMailAddress]</InArgument>
                                                    </ui:AddTransactionItem.TransactionInformation>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddTransactionItem>
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID46">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">537.5,1439</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">537.5,1464.5 487.5,1464.5</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_25" Level="Info" Message="[&quot;==FetchEmail== New transaction item: &quot; +out_qi_TransactionItem.Reference+ &quot; added to the queue: &quot; +in_str_QueueName+ &quot;.&quot;]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:LogMessage>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID11">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">287.5,1439</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">287.5,1464.5 237.5,1464.5</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:PathExists DisplayName="Path Exists: str_AttachFolderPath?" Exists="[bln_AttachFolderExists]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="PathExists_1" Path="[str_LocalAttachPath]" PathType="Folder">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:PathExists>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID16">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">37.5,1439</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">137.5,1490 137.5,1520 387,1520 387,1538</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_9" Level="Info" Message="[&quot;==FetchEmail== &quot; +str_LocalAttachPath+ &quot; exists: &quot; +bln_AttachFolderExists.ToString+ &quot;.&quot;]">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </ui:LogMessage>
                                                              <FlowStep.Next>
                                                                <FlowDecision x:Name="__ReferenceID12" sap2010:Annotation.AnnotationText="bln_AttachFolderExists=True?" Condition="[bln_AttachFolderExists]" DisplayName="FD: bln_AttachFolderExists" sap:VirtualizedContainerService.HintSize="156,129" sap2010:WorkflowViewState.IdRef="FlowDecision_2">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <av:Point x:Key="ShapeLocation">309,1538</av:Point>
                                                                      <av:Size x:Key="ShapeSize">156,129</av:Size>
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                      <av:PointCollection x:Key="TrueConnector">309,1602.5 249,1602.5</av:PointCollection>
                                                                      <av:PointCollection x:Key="FalseConnector">465,1602.5 480,1602.5 480,1684.5 390,1684.5 390,1714.5</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <FlowDecision.True>
                                                                    <FlowStep x:Name="__ReferenceID13">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">49,1577</av:Point>
                                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">149,1628 149,1740 290,1740</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:Delete ContinueOnError="{x:Null}" DisplayName="Delete: str_LocalAttachPath" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Delete_1" Path="[str_LocalAttachPath]">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </ui:Delete>
                                                                      <FlowStep.Next>
                                                                        <FlowStep x:Name="__ReferenceID2">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">290,1714.5</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">490,1740 540,1740</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create Folder: str_LocalAttachPath" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="[str_LocalAttachPath]">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </ui:CreateDirectory>
                                                                          <FlowStep.Next>
                                                                            <FlowStep x:Name="__ReferenceID48">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">540,1714.5</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">640,1765.5 640,1795.5 390,1795.5 390,1806.5</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:SaveMailAttachments Attachments="[iEnum_Attachments]" DisplayName="Save Attachments: PDF" Filter="^.*\.(pdf).*$" FolderPath="[str_LocalAttachPath]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="SaveMailAttachments_1" Message="[out_o365m_ProcessingMail]" OverwriteExisting="True">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:SaveMailAttachments>
                                                                              <FlowStep.Next>
                                                                                <FlowStep x:Name="__ReferenceID17">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">290,1806.5</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">390,1857.5 390,1908.5</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_11" Level="Info" Message="[&quot;==FetchEmail== &quot; +iEnum_Attachments.Count.ToString+ &quot; file saved in &quot; +str_LocalAttachPath+ &quot;.&quot;]">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </ui:LogMessage>
                                                                                  <FlowStep.Next>
                                                                                    <FlowDecision x:Name="__ReferenceID14" sap2010:Annotation.AnnotationText="Includes only 1 PDF attachment?" Condition="[iEnum_Attachments(0) IsNot Nothing And iEnum_Attachments.Count=1]" DisplayName="FD: PDF attachment" sap:VirtualizedContainerService.HintSize="145,129" sap2010:WorkflowViewState.IdRef="FlowDecision_3">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <av:Point x:Key="ShapeLocation">317.5,1908.5</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">145,129</av:Size>
                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                          <av:PointCollection x:Key="FalseConnector">462.5,1973 512.5,1973</av:PointCollection>
                                                                                          <av:PointCollection x:Key="TrueConnector">317.5,1973 247.5,1973</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <FlowDecision.True>
                                                                                        <FlowStep x:Name="__ReferenceID32">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">47.5,1926.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">200,93</av:Size>
                                                                                              <av:PointCollection x:Key="ConnectorLocation">147.5,2019.5 147.5,2059.5</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:MultipleAssign sap2010:Annotation.AnnotationText="str_Pg2StoragePath&#xA;str_Pg6StoragePath" DisplayName="Multiple Assign: Assign StoragePaths" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="MultipleAssign_10">
                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[out_str_Pg2StoragePath]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">[str_LocalAttachPath.Replace("Data\Temp\","")+"\Pg2.png"]</InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                                                                                                  <ui:AssignOperation.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[out_str_Pg6StoragePath]</OutArgument>
                                                                                                  </ui:AssignOperation.To>
                                                                                                  <ui:AssignOperation.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">[str_LocalAttachPath.Replace("Data\Temp\","")+"\Pg6.png"]</InArgument>
                                                                                                  </ui:AssignOperation.Value>
                                                                                                </ui:AssignOperation>
                                                                                              </scg:List>
                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </ui:MultipleAssign>
                                                                                          <FlowStep.Next>
                                                                                            <FlowStep x:Name="__ReferenceID39">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <av:Point x:Key="ShapeLocation">47.5,2059.5</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                  <av:PointCollection x:Key="ConnectorLocation">147.5,2110.5 147.5,2160.5</av:PointCollection>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <upap:GetPDFPageCount DisplayName="Get PDF Page Count: iEnum_Attachments(0)" FileName="[iEnum_Attachments(0)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="GetPDFPageCount_1" PageCount="[int_PDFPgCount]">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </upap:GetPDFPageCount>
                                                                                              <FlowStep.Next>
                                                                                                <FlowDecision x:Name="__ReferenceID40" Condition="[int_PDFPgCount&gt;=6]" DisplayName="FD: PDF has atleast 6 Pgs?" sap:VirtualizedContainerService.HintSize="141,87" sap2010:WorkflowViewState.IdRef="FlowDecision_8">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <av:Point x:Key="ShapeLocation">77,2160.5</av:Point>
                                                                                                      <av:Size x:Key="ShapeSize">141,87</av:Size>
                                                                                                      <av:PointCollection x:Key="TrueConnector">77,2204 57.5,2204 57.5,2272 147.5,2272 147.5,2302</av:PointCollection>
                                                                                                      <av:PointCollection x:Key="FalseConnector">218,2204 248,2204 248,2263 512.5,2263</av:PointCollection>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <FlowDecision.True>
                                                                                                    <FlowStep x:Name="__ReferenceID20">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <av:Point x:Key="ShapeLocation">47.5,2302</av:Point>
                                                                                                          <av:Size x:Key="ShapeSize">200,82</av:Size>
                                                                                                          <av:PointCollection x:Key="ConnectorLocation">247.5,2343 297.5,2343</av:PointCollection>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <upap:ExportPDFPageAsImage sap2010:Annotation.AnnotationText="Convert Pg 2 as an img." DisplayName="Export PDF Page As Image - Pg. 2" FileName="[iEnum_Attachments(0)]" sap:VirtualizedContainerService.HintSize="200,82" sap2010:WorkflowViewState.IdRef="ExportPDFPageAsImage_2" ImageDpi="150" OutputFileName="[str_LocalAttachPath+&quot;\Pg2.png&quot;]" PageNumber="2">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                      </upap:ExportPDFPageAsImage>
                                                                                                      <FlowStep.Next>
                                                                                                        <FlowStep x:Name="__ReferenceID22">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <av:Point x:Key="ShapeLocation">297.5,2296.5</av:Point>
                                                                                                              <av:Size x:Key="ShapeSize">200,93</av:Size>
                                                                                                              <av:PointCollection x:Key="ConnectorLocation">397.5,2389.5 397.5,2439.5</av:PointCollection>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                          <ucas:UploadStorageFile TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Upload Pg2 img to storage bucket." Destination="[out_str_Pg2StoragePath]" DisplayName="Upload Storage File: Pg2.png" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="UploadStorageFile_1" Path="[str_LocalAttachPath+&quot;\Pg2.png&quot;]" StorageBucketName="[in_str_StorageBucket]">
                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                              </scg:Dictionary>
                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                          </ucas:UploadStorageFile>
                                                                                                          <FlowStep.Next>
                                                                                                            <FlowStep x:Name="__ReferenceID21">
                                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                  <av:Point x:Key="ShapeLocation">297.5,2439.5</av:Point>
                                                                                                                  <av:Size x:Key="ShapeSize">200,82</av:Size>
                                                                                                                  <av:PointCollection x:Key="ConnectorLocation">297.5,2480.5 247.5,2480.5</av:PointCollection>
                                                                                                                </scg:Dictionary>
                                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                                              <upap:ExportPDFPageAsImage sap2010:Annotation.AnnotationText="Convert Pg 6 as an img." DisplayName="Export PDF Page As Image - Pg. 6" FileName="[iEnum_Attachments(0)]" sap:VirtualizedContainerService.HintSize="200,82" sap2010:WorkflowViewState.IdRef="ExportPDFPageAsImage_3" ImageDpi="150" OutputFileName="[str_LocalAttachPath+&quot;\Pg6.png&quot;]" PageNumber="6">
                                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                  </scg:Dictionary>
                                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                              </upap:ExportPDFPageAsImage>
                                                                                                              <FlowStep.Next>
                                                                                                                <FlowStep x:Name="__ReferenceID23">
                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                      <av:Point x:Key="ShapeLocation">47.5,2434</av:Point>
                                                                                                                      <av:Size x:Key="ShapeSize">200,93</av:Size>
                                                                                                                      <av:PointCollection x:Key="ConnectorLocation">147.5,2527 147.5,2557 147.395,2557 147.395,2567</av:PointCollection>
                                                                                                                    </scg:Dictionary>
                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                  <ucas:UploadStorageFile TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Upload Pg6 img to storage bucket." Destination="[out_str_Pg6StoragePath]" DisplayName="Upload Storage File: Pg6.png" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="UploadStorageFile_2" Path="[str_LocalAttachPath+&quot;\Pg6.png&quot;]" StorageBucketName="[in_str_StorageBucket]">
                                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                      </scg:Dictionary>
                                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                                  </ucas:UploadStorageFile>
                                                                                                                  <FlowStep.Next>
                                                                                                                    <FlowStep x:Name="__ReferenceID47">
                                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                          <av:Point x:Key="ShapeLocation">16.395,2567</av:Point>
                                                                                                                          <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                                                          <av:PointCollection x:Key="ConnectorLocation">147.395,2627 147.395,2657 147.5,2657 147.5,2667</av:PointCollection>
                                                                                                                        </scg:Dictionary>
                                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                                      <Assign DisplayName="Assign: bln_ImgUploaded= True" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_21">
                                                                                                                        <Assign.To>
                                                                                                                          <OutArgument x:TypeArguments="x:Boolean">[bln_ImgUploaded]</OutArgument>
                                                                                                                        </Assign.To>
                                                                                                                        <Assign.Value>
                                                                                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                                                                        </Assign.Value>
                                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                                          </scg:Dictionary>
                                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                                      </Assign>
                                                                                                                      <FlowStep.Next>
                                                                                                                        <FlowStep x:Name="__ReferenceID29">
                                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                              <av:Point x:Key="ShapeLocation">47.5,2667</av:Point>
                                                                                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                              <av:PointCollection x:Key="ConnectorLocation">247.5,2692.5 277.5,2692.5 277.5,2602 297.5,2602</av:PointCollection>
                                                                                                                            </scg:Dictionary>
                                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_13" Level="Info" Message="[&quot;==FetchEmail== Files: &quot; +out_str_Pg2StoragePath+ &quot; and &quot; +out_str_Pg6StoragePath+ &quot; uploaded to storage bucket: &quot; +in_str_StorageBucket+ &quot;.&quot;]">
                                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                              </scg:Dictionary>
                                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                                          </ui:LogMessage>
                                                                                                                          <FlowStep.Next>
                                                                                                                            <FlowStep x:Name="__ReferenceID24">
                                                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                  <av:Point x:Key="ShapeLocation">297.5,2548</av:Point>
                                                                                                                                  <av:Size x:Key="ShapeSize">200,108</av:Size>
                                                                                                                                  <av:PointCollection x:Key="ConnectorLocation">397.5,2656 397.5,2706.5</av:PointCollection>
                                                                                                                                </scg:Dictionary>
                                                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                                                              <umaf:FindFilesAndFolders DriveName="{x:Null}" First="{x:Null}" Query="{x:Null}" sap2010:Annotation.AnnotationText="Fetch drive items of all the folders within in_str_SPRootFolder" DisplayName="Find Files And Folders: in_str_SPRootFolder" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="FindFilesAndFolders_1" Results="[out_di_SubFolders]" SiteUrl="[in_str_SPSite]" Subfolder="[in_str_SPRootFolder]">
                                                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                  </scg:Dictionary>
                                                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                                              </umaf:FindFilesAndFolders>
                                                                                                                              <FlowStep.Next>
                                                                                                                                <FlowDecision x:Name="__ReferenceID25" sap2010:Annotation.AnnotationText="Sub folders present in root folder?" Condition="[out_di_SubFolders.Count&gt;0]" DisplayName="FD: Has sub folders?" sap:VirtualizedContainerService.HintSize="156,129" sap2010:WorkflowViewState.IdRef="FlowDecision_4">
                                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                      <av:Point x:Key="ShapeLocation">319.5,2706.5</av:Point>
                                                                                                                                      <av:Size x:Key="ShapeSize">156,129</av:Size>
                                                                                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                      <av:PointCollection x:Key="FalseConnector">475.5,2771 525.5,2771</av:PointCollection>
                                                                                                                                      <av:PointCollection x:Key="TrueConnector">319.5,2771 249.5,2771</av:PointCollection>
                                                                                                                                    </scg:Dictionary>
                                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                                  <FlowDecision.True>
                                                                                                                                    <FlowStep x:Name="__ReferenceID30">
                                                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                          <av:Point x:Key="ShapeLocation">49.5,2745.5</av:Point>
                                                                                                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                                          <av:PointCollection x:Key="ConnectorLocation">149.5,2796.5 149.5,2845.02</av:PointCollection>
                                                                                                                                        </scg:Dictionary>
                                                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_14" Level="Info" Message="[&quot;==FetchEmail== &quot; +out_di_SubFolders.Count.ToString+ &quot; subfolder(s) present in root folder: &quot; +in_str_SPRootFolder+ &quot;.&quot;]">
                                                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                          </scg:Dictionary>
                                                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                                                      </ui:LogMessage>
                                                                                                                                      <FlowStep.Next>
                                                                                                                                        <FlowStep x:Name="__ReferenceID26">
                                                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                              <av:Point x:Key="ShapeLocation">49.5,2845.02</av:Point>
                                                                                                                                              <av:Size x:Key="ShapeSize">200,108</av:Size>
                                                                                                                                              <av:PointCollection x:Key="ConnectorLocation">249.5,2899.02 279.5,2899.02 279.5,2866.02 389.5,2866.02 389.5,2896.02</av:PointCollection>
                                                                                                                                            </scg:Dictionary>
                                                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                                                          <ui:ForEach x:TypeArguments="mg:DriveItem" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Find subfolder - 01.Validate and upload the PDF attachment." DisplayName="For Each: Subfolder in di_SubFolders" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[out_di_SubFolders]">
                                                                                                                                            <ui:ForEach.Body>
                                                                                                                                              <ActivityAction x:TypeArguments="mg:DriveItem">
                                                                                                                                                <ActivityAction.Argument>
                                                                                                                                                  <DelegateInArgument x:TypeArguments="mg:DriveItem" Name="di_SubFolder" />
                                                                                                                                                </ActivityAction.Argument>
                                                                                                                                                <If Condition="[di_SubFolder.Name=in_str_SPValidateFolder]" DisplayName="If: di_SubFolder.Name=&quot;01.Validate&quot;" sap:VirtualizedContainerService.HintSize="484,556" sap2010:WorkflowViewState.IdRef="If_2">
                                                                                                                                                  <If.Then>
                                                                                                                                                    <Sequence DisplayName="Sequence: Upload file and break loop" sap:VirtualizedContainerService.HintSize="376,369" sap2010:WorkflowViewState.IdRef="Sequence_7">
                                                                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                        </scg:Dictionary>
                                                                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_15" Level="Info" Message="[&quot;==FetchEmail== &quot; +in_str_SPValidateFolder+ &quot; subfolder present in root folder: &quot; +in_str_SPRootFolder+ &quot;.&quot;]">
                                                                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                          </scg:Dictionary>
                                                                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      </ui:LogMessage>
                                                                                                                                                      <umaf:UploadFile CloudFileName="{x:Null}" Metadata="{x:Null}" ConflictBehavior="Replace" Destination="[di_SubFolder]" DisplayName="Upload File: Attachement to 01.Validate" sap:VirtualizedContainerService.HintSize="334,84" sap2010:WorkflowViewState.IdRef="UploadFile_1" LocalFilePath="[iEnum_Attachments(0)]" Result="[out_di_Attachment]" />
                                                                                                                                                      <ui:Break DisplayName="Break: loop" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Break_2" />
                                                                                                                                                    </Sequence>
                                                                                                                                                  </If.Then>
                                                                                                                                                </If>
                                                                                                                                              </ActivityAction>
                                                                                                                                            </ui:ForEach.Body>
                                                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                              </scg:Dictionary>
                                                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                                                          </ui:ForEach>
                                                                                                                                          <FlowStep.Next>
                                                                                                                                            <FlowDecision x:Name="__ReferenceID27" sap2010:Annotation.AnnotationText="Has the attachment been uploaded?" Condition="[out_di_Attachment IsNot Nothing]" DisplayName="FD: Attachment uploaded?" sap:VirtualizedContainerService.HintSize="147,129" sap2010:WorkflowViewState.IdRef="FlowDecision_5">
                                                                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                  <av:Point x:Key="ShapeLocation">316,2896.02</av:Point>
                                                                                                                                                  <av:Size x:Key="ShapeSize">147,129</av:Size>
                                                                                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                                  <av:PointCollection x:Key="FalseConnector">463,2960.52 523,2960.52</av:PointCollection>
                                                                                                                                                  <av:PointCollection x:Key="TrueConnector">316,2960.52 150,2960.52 150,2984.5</av:PointCollection>
                                                                                                                                                </scg:Dictionary>
                                                                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                                                                              <FlowDecision.True>
                                                                                                                                                <FlowStep x:Name="__ReferenceID31">
                                                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                      <av:Point x:Key="ShapeLocation">50,2984.5</av:Point>
                                                                                                                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                                                      <av:PointCollection x:Key="ConnectorLocation">150,3035.5 150,3065.5 15.5,3065.5 15.5,3379 45.5,3379</av:PointCollection>
                                                                                                                                                    </scg:Dictionary>
                                                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_16" Level="Info" Message="[&quot;==FetchEmail== PDF attachement uploaded to: &quot; +in_str_SPValidateFolder+ &quot;. URL: &quot; +out_di_Attachment.WebUrl+ &quot;.&quot;]">
                                                                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                      </scg:Dictionary>
                                                                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                  </ui:LogMessage>
                                                                                                                                                  <FlowStep.Next>
                                                                                                                                                    <FlowStep x:Name="__ReferenceID0">
                                                                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                          <av:Point x:Key="ShapeLocation">45.5,3353.5</av:Point>
                                                                                                                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                                                          <av:PointCollection x:Key="ConnectorLocation">245.5,3379 295.5,3379</av:PointCollection>
                                                                                                                                                        </scg:Dictionary>
                                                                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      <ui:Delete ContinueOnError="{x:Null}" DisplayName="Delete: str_LocalAttachPath" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Delete_2" Path="[str_LocalAttachPath]">
                                                                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                          </scg:Dictionary>
                                                                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      </ui:Delete>
                                                                                                                                                      <FlowStep.Next>
                                                                                                                                                        <FlowStep x:Name="__ReferenceID35">
                                                                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                              <av:Point x:Key="ShapeLocation">295.5,3353.5</av:Point>
                                                                                                                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                                                              <av:PointCollection x:Key="ConnectorLocation">395.5,3404.5 395.5,3454.5</av:PointCollection>
                                                                                                                                                            </scg:Dictionary>
                                                                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_19" Level="Info" Message="[&quot;==FetchEmail== Local folder: &quot; +str_LocalAttachPath+ &quot; deleted.&quot;]">
                                                                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                              </scg:Dictionary>
                                                                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                          </ui:LogMessage>
                                                                                                                                                          <FlowStep.Next>
                                                                                                                                                            <FlowDecision x:Name="__ReferenceID37" sap2010:Annotation.AnnotationText="exp_Exception Is Nothing" Condition="[exp_Exception Is Nothing]" DisplayName="FD: Success/Exception?" sap:VirtualizedContainerService.HintSize="129,129" sap2010:WorkflowViewState.IdRef="FlowDecision_7">
                                                                                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                                  <av:Point x:Key="ShapeLocation">331,3454.5</av:Point>
                                                                                                                                                                  <av:Size x:Key="ShapeSize">129,129</av:Size>
                                                                                                                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                                                  <av:PointCollection x:Key="FalseConnector">460,3519 520,3519</av:PointCollection>
                                                                                                                                                                  <av:PointCollection x:Key="TrueConnector">331,3519 271,3519</av:PointCollection>
                                                                                                                                                                </scg:Dictionary>
                                                                                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                              <FlowDecision.True>
                                                                                                                                                                <FlowStep x:Name="__ReferenceID38">
                                                                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                      <av:Point x:Key="ShapeLocation">71,3493.5</av:Point>
                                                                                                                                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                                                                    </scg:Dictionary>
                                                                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_21" Level="Info" Message="[&quot;==FetchEmail== Completed.&quot;]">
                                                                                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                                      </scg:Dictionary>
                                                                                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  </ui:LogMessage>
                                                                                                                                                                </FlowStep>
                                                                                                                                                              </FlowDecision.True>
                                                                                                                                                              <FlowDecision.False>
                                                                                                                                                                <FlowStep x:Name="__ReferenceID28">
                                                                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                      <av:Point x:Key="ShapeLocation">520,3508</av:Point>
                                                                                                                                                                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                                                                                                                                    </scg:Dictionary>
                                                                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  <Throw DisplayName="Throw: exp_Exception" Exception="[exp_Exception]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_4">
                                                                                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                                      </scg:Dictionary>
                                                                                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  </Throw>
                                                                                                                                                                </FlowStep>
                                                                                                                                                              </FlowDecision.False>
                                                                                                                                                            </FlowDecision>
                                                                                                                                                          </FlowStep.Next>
                                                                                                                                                        </FlowStep>
                                                                                                                                                      </FlowStep.Next>
                                                                                                                                                    </FlowStep>
                                                                                                                                                  </FlowStep.Next>
                                                                                                                                                </FlowStep>
                                                                                                                                              </FlowDecision.True>
                                                                                                                                              <FlowDecision.False>
                                                                                                                                                <FlowStep x:Name="__ReferenceID44">
                                                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                      <av:Point x:Key="ShapeLocation">523,2872.02</av:Point>
                                                                                                                                                      <av:Size x:Key="ShapeSize">262,177</av:Size>
                                                                                                                                                      <av:PointCollection x:Key="ConnectorLocation">785,2960.52 805.5,2960.52 805.5,3061.5 685.5,3061.5 685.5,3091.5</av:PointCollection>
                                                                                                                                                    </scg:Dictionary>
                                                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                  <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Subfolder:&quot; +in_str_SPValidateFolder+ &quot; was not found in the root folder: &quot; +in_str_SPRootFolder+ &quot;. Please validate either the subfolder is created or the asset is updated with the correct subfolder name.&quot;)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,177" sap2010:WorkflowViewState.IdRef="Assign_10">
                                                                                                                                                    <Assign.To>
                                                                                                                                                      <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                                                                                                                                                    </Assign.To>
                                                                                                                                                    <Assign.Value>
                                                                                                                                                      <InArgument x:TypeArguments="s:SystemException">[New SystemException("Subfolder:" +in_str_SPValidateFolder+ " was not found in the root folder: " +in_str_SPRootFolder+ ". Please validate either the subfolder is created or the asset is updated with the correct subfolder name.")]</InArgument>
                                                                                                                                                    </Assign.Value>
                                                                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                                      </scg:Dictionary>
                                                                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                  </Assign>
                                                                                                                                                  <FlowStep.Next>
                                                                                                                                                    <FlowDecision x:Name="__ReferenceID1" sap2010:Annotation.AnnotationText="Files uploaded to storage Bucket?" Condition="[bln_ImgUploaded]" DisplayName="FD: Files uploaded to Storage Bucket?" sap:VirtualizedContainerService.HintSize="160,129" sap2010:WorkflowViewState.IdRef="FlowDecision_6">
                                                                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                          <av:Point x:Key="ShapeLocation">565.5,3091.5</av:Point>
                                                                                                                                                          <av:Size x:Key="ShapeSize">160,129</av:Size>
                                                                                                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                                          <av:PointCollection x:Key="TrueConnector">565.5,3156 495.5,3156</av:PointCollection>
                                                                                                                                                          <av:PointCollection x:Key="FalseConnector">725.5,3156 745.5,3156 745.5,3323.5 145.5,3323.5 145.5,3353.5</av:PointCollection>
                                                                                                                                                        </scg:Dictionary>
                                                                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                      <FlowDecision.True>
                                                                                                                                                        <FlowStep x:Name="__ReferenceID33">
                                                                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                              <av:Point x:Key="ShapeLocation">295.5,3109.5</av:Point>
                                                                                                                                                              <av:Size x:Key="ShapeSize">200,93</av:Size>
                                                                                                                                                              <av:PointCollection x:Key="ConnectorLocation">295.5,3156 245.5,3156</av:PointCollection>
                                                                                                                                                            </scg:Dictionary>
                                                                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                          <ucas:DeleteStorageFile TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Delete Pg2 img from storage bucket." DisplayName="Delete Storage File: Pg2.png" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="DeleteStorageFile_1" Path="[out_str_Pg2StoragePath]" StorageBucketName="[in_str_StorageBucket]">
                                                                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                                              </scg:Dictionary>
                                                                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                          </ucas:DeleteStorageFile>
                                                                                                                                                          <FlowStep.Next>
                                                                                                                                                            <FlowStep x:Name="__ReferenceID34">
                                                                                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                  <av:Point x:Key="ShapeLocation">45.5,3109.5</av:Point>
                                                                                                                                                                  <av:Size x:Key="ShapeSize">200,93</av:Size>
                                                                                                                                                                  <av:PointCollection x:Key="ConnectorLocation">145.5,3202.5 145.5,3252.5</av:PointCollection>
                                                                                                                                                                </scg:Dictionary>
                                                                                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                              <ucas:DeleteStorageFile TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Delete Pg6 img from storage bucket." DisplayName="Delete Storage File: Pg6.png" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="DeleteStorageFile_2" Path="[out_str_Pg6StoragePath]" StorageBucketName="[in_str_StorageBucket]">
                                                                                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                                                  </scg:Dictionary>
                                                                                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                              </ucas:DeleteStorageFile>
                                                                                                                                                              <FlowStep.Next>
                                                                                                                                                                <FlowStep x:Name="__ReferenceID36">
                                                                                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                      <av:Point x:Key="ShapeLocation">45.5,3252.5</av:Point>
                                                                                                                                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                                                                                      <av:PointCollection x:Key="ConnectorLocation">145.5,3303.5 145.5,3353.5</av:PointCollection>
                                                                                                                                                                    </scg:Dictionary>
                                                                                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_22" Level="Info" Message="[&quot;==FetchEmail== Storage files: &quot; +out_str_Pg2StoragePath+ &quot; and &quot; +out_str_Pg6StoragePath+ &quot; deleted from storage bucket: &quot; +in_str_StorageBucket+ &quot;.&quot;]">
                                                                                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                                                      </scg:Dictionary>
                                                                                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                                                                                  </ui:LogMessage>
                                                                                                                                                                  <FlowStep.Next>
                                                                                                                                                                    <x:Reference>__ReferenceID0</x:Reference>
                                                                                                                                                                  </FlowStep.Next>
                                                                                                                                                                </FlowStep>
                                                                                                                                                              </FlowStep.Next>
                                                                                                                                                            </FlowStep>
                                                                                                                                                          </FlowStep.Next>
                                                                                                                                                        </FlowStep>
                                                                                                                                                      </FlowDecision.True>
                                                                                                                                                      <FlowDecision.False>
                                                                                                                                                        <x:Reference>__ReferenceID0</x:Reference>
                                                                                                                                                      </FlowDecision.False>
                                                                                                                                                    </FlowDecision>
                                                                                                                                                  </FlowStep.Next>
                                                                                                                                                </FlowStep>
                                                                                                                                              </FlowDecision.False>
                                                                                                                                            </FlowDecision>
                                                                                                                                          </FlowStep.Next>
                                                                                                                                        </FlowStep>
                                                                                                                                      </FlowStep.Next>
                                                                                                                                    </FlowStep>
                                                                                                                                  </FlowDecision.True>
                                                                                                                                  <FlowDecision.False>
                                                                                                                                    <FlowStep x:Name="__ReferenceID43">
                                                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                          <av:Point x:Key="ShapeLocation">525.5,2697.5</av:Point>
                                                                                                                                          <av:Size x:Key="ShapeSize">262,147</av:Size>
                                                                                                                                          <av:PointCollection x:Key="ConnectorLocation">787.5,2771 805.5,2771 805.5,3061.5 685.5,3061.5 685.5,3091.5</av:PointCollection>
                                                                                                                                        </scg:Dictionary>
                                                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                                                      <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;No subfolders present within the folder: &quot; +in_str_SPRootFolder+ &quot;. Please validate either the folder path is valid or the subfolders are present.&quot;)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,147" sap2010:WorkflowViewState.IdRef="Assign_9">
                                                                                                                                        <Assign.To>
                                                                                                                                          <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                                                                                                                                        </Assign.To>
                                                                                                                                        <Assign.Value>
                                                                                                                                          <InArgument x:TypeArguments="s:Exception">[New SystemException("No subfolders present within the folder: " +in_str_SPRootFolder+ ". Please validate either the folder path is valid or the subfolders are present.")]</InArgument>
                                                                                                                                        </Assign.Value>
                                                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                                                          </scg:Dictionary>
                                                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                                                      </Assign>
                                                                                                                                      <FlowStep.Next>
                                                                                                                                        <x:Reference>__ReferenceID1</x:Reference>
                                                                                                                                      </FlowStep.Next>
                                                                                                                                    </FlowStep>
                                                                                                                                  </FlowDecision.False>
                                                                                                                                </FlowDecision>
                                                                                                                              </FlowStep.Next>
                                                                                                                            </FlowStep>
                                                                                                                          </FlowStep.Next>
                                                                                                                        </FlowStep>
                                                                                                                      </FlowStep.Next>
                                                                                                                    </FlowStep>
                                                                                                                  </FlowStep.Next>
                                                                                                                </FlowStep>
                                                                                                              </FlowStep.Next>
                                                                                                            </FlowStep>
                                                                                                          </FlowStep.Next>
                                                                                                        </FlowStep>
                                                                                                      </FlowStep.Next>
                                                                                                    </FlowStep>
                                                                                                  </FlowDecision.True>
                                                                                                  <FlowDecision.False>
                                                                                                    <FlowStep x:Name="__ReferenceID42">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <av:Point x:Key="ShapeLocation">512.5,2137</av:Point>
                                                                                                          <av:Size x:Key="ShapeSize">262,252</av:Size>
                                                                                                          <av:PointCollection x:Key="ConnectorLocation">774.5,2263 804.5,2263 804.5,3061.5 685.5,3061.5 685.5,3091.5</av:PointCollection>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <Assign sap2010:Annotation.AnnotationText="New BusinessRuleException(&quot;Email received from: &quot; +out_o365m_ProcessingMail.Sender.Address+ &quot; with the subject: &quot; +out_o365m_ProcessingMail.Subject+ &quot; at: &quot; +out_o365m_ProcessingMail.ReceivedDateTime.ToString+ &quot;had a PDF attachment with less than 6 pages. The email has been moved to the folder: &quot; +in_str_RejectedFolder+ &quot;. Please validate and action appropriately.&quot;)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,252" sap2010:WorkflowViewState.IdRef="Assign_8">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="s:Exception">[New BusinessRuleException("Email received from: " +out_o365m_ProcessingMail.Sender.Address+ " with the subject: " +out_o365m_ProcessingMail.Subject+ " at: " +out_o365m_ProcessingMail.ReceivedDateTime.ToString+ "had a PDF attachment with less than 6 pages. The email has been moved to the folder: " +in_str_RejectedFolder+ ". Please validate and action appropriately.")]</InArgument>
                                                                                                        </Assign.Value>
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                      </Assign>
                                                                                                      <FlowStep.Next>
                                                                                                        <x:Reference>__ReferenceID1</x:Reference>
                                                                                                      </FlowStep.Next>
                                                                                                    </FlowStep>
                                                                                                  </FlowDecision.False>
                                                                                                </FlowDecision>
                                                                                              </FlowStep.Next>
                                                                                            </FlowStep>
                                                                                          </FlowStep.Next>
                                                                                        </FlowStep>
                                                                                      </FlowDecision.True>
                                                                                      <FlowDecision.False>
                                                                                        <FlowStep x:Name="__ReferenceID41">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">512.5,1847</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">262,252</av:Size>
                                                                                              <av:PointCollection x:Key="ConnectorLocation">774.5,1973 804.5,1973 804.5,3061.5 685.5,3061.5 685.5,3091.5</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap2010:Annotation.AnnotationText="New BusinessRuleException(&quot;Email received from: &quot; +out_o365m_ProcessingMail.Sender.Address+ &quot; with the subject: &quot; +out_o365m_ProcessingMail.Subject+ &quot; at: &quot; +out_o365m_ProcessingMail.ReceivedDateTime.ToString+ &quot;had attachment(s) other than PDF. The email has been moved to the folder: &quot; +in_str_RejectedFolder+ &quot;. Please validate and action appropriately.&quot;)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,252" sap2010:WorkflowViewState.IdRef="Assign_7">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="s:Exception">[New BusinessRuleException("Email received from: " +out_o365m_ProcessingMail.Sender.Address+ " with the subject: " +out_o365m_ProcessingMail.Subject+ " at: " +out_o365m_ProcessingMail.ReceivedDateTime.ToString+ "had attachment(s) other than PDF. The email has been moved to the folder: " +in_str_RejectedFolder+ ". Please validate and action appropriately.")]</InArgument>
                                                                                            </Assign.Value>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </Assign>
                                                                                          <FlowStep.Next>
                                                                                            <x:Reference>__ReferenceID1</x:Reference>
                                                                                          </FlowStep.Next>
                                                                                        </FlowStep>
                                                                                      </FlowDecision.False>
                                                                                    </FlowDecision>
                                                                                  </FlowStep.Next>
                                                                                </FlowStep>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowDecision.True>
                                                                  <FlowDecision.False>
                                                                    <x:Reference>__ReferenceID2</x:Reference>
                                                                  </FlowDecision.False>
                                                                </FlowDecision>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowStep.Next>
                                </FlowStep>
                              </FlowStep.Next>
                            </FlowStep>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowDecision.False>
                    </FlowDecision>
                  </FlowStep.Next>
                </FlowStep>
                <FlowStep x:Name="__ReferenceID4">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">290,478.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,243</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">390,721.5 390,771.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:RetryScope sap2010:Annotation.AnnotationText="Get Mail: in_str_MailFolder included within Retry Scope should Logic App trigger more than one instance at the same time interval.&#xA;&#xA;Fetch first email:&#xA;in_strAccount&#xA;in_str_MailFolder&#xA;&#xA;Store in:&#xA;o365m_Mails" DisplayName="Retry Scope: Get Mail: in_str_MailFolder" sap:VirtualizedContainerService.HintSize="200,243" sap2010:WorkflowViewState.IdRef="RetryScope_2" NumberOfRetries="3" RetryInterval="00:00:05">
                    <ui:RetryScope.ActivityBody>
                      <ActivityAction>
                        <umam:GetMail Query="{x:Null}" Account="[in_str_Account]" sap2010:Annotation.AnnotationText="Fetch first email:&#xA;in_strAccount&#xA;in_str_MailFolder&#xA;&#xA;Store in:&#xA;o365m_Mails" DisplayName="Get Mail: in_str_MailFolder" GetAsHTML="False" sap:VirtualizedContainerService.HintSize="200,124" sap2010:WorkflowViewState.IdRef="GetMail_3" MailFolder="[in_str_MailFolder]" MarkAsRead="True" OnlyUnreadMessages="False" Results="[o365m_Mails]" Top="1">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </umam:GetMail>
                      </ActivityAction>
                    </ui:RetryScope.ActivityBody>
                    <ui:RetryScope.Condition>
                      <ActivityFunc x:TypeArguments="x:Boolean" />
                    </ui:RetryScope.Condition>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:RetryScope>
                  <FlowStep.Next>
                    <x:Reference>__ReferenceID3</x:Reference>
                  </FlowStep.Next>
                </FlowStep>
                <FlowStep x:Name="__ReferenceID49">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">290,127.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">390,178.5 390,218.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Info" Message="[&quot;==FetchEmail== Read email from folder: &quot; +in_str_MailFolder+ &quot;.&quot;]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:LogMessage>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID18">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">290,218.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,213</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">390,431.5 390,478.5</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:MultipleAssign sap2010:Annotation.AnnotationText="str_PMailSubject&#xA;str_PMailId&#xA;str_PMailAddress&#xA;str_PMailTimeStamp&#xA;str_TranRef&#xA;str_LocalAttachPath&#xA;str_Pg2StoragePath&#xA;str_Pg6StoragePath&#xA;exp_Exception&#xA;str_MailMoveFolder" DisplayName="Multiple Assign: Initialise variables" sap:VirtualizedContainerService.HintSize="200,213" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                        <ui:MultipleAssign.AssignOperations>
                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_8">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_PMailSubject]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_PMailId]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_PMailAddress]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_PMailTimeStamp]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_TranRef]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_LocalAttachPath]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[out_str_Pg2StoragePath]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[out_str_Pg6StoragePath]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[str_MailMoveFolder]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                          </scg:List>
                        </ui:MultipleAssign.AssignOperations>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:MultipleAssign>
                      <FlowStep.Next>
                        <x:Reference>__ReferenceID4</x:Reference>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
                <x:Reference>__ReferenceID5</x:Reference>
                <x:Reference>__ReferenceID6</x:Reference>
                <x:Reference>__ReferenceID7</x:Reference>
                <x:Reference>__ReferenceID8</x:Reference>
                <x:Reference>__ReferenceID9</x:Reference>
                <x:Reference>__ReferenceID10</x:Reference>
                <x:Reference>__ReferenceID11</x:Reference>
                <x:Reference>__ReferenceID12</x:Reference>
                <x:Reference>__ReferenceID13</x:Reference>
                <x:Reference>__ReferenceID2</x:Reference>
                <x:Reference>__ReferenceID14</x:Reference>
                <x:Reference>__ReferenceID15</x:Reference>
                <x:Reference>__ReferenceID16</x:Reference>
                <x:Reference>__ReferenceID17</x:Reference>
                <x:Reference>__ReferenceID18</x:Reference>
                <x:Reference>__ReferenceID19</x:Reference>
                <x:Reference>__ReferenceID20</x:Reference>
                <x:Reference>__ReferenceID21</x:Reference>
                <x:Reference>__ReferenceID22</x:Reference>
                <x:Reference>__ReferenceID23</x:Reference>
                <x:Reference>__ReferenceID24</x:Reference>
                <x:Reference>__ReferenceID25</x:Reference>
                <x:Reference>__ReferenceID26</x:Reference>
                <x:Reference>__ReferenceID27</x:Reference>
                <x:Reference>__ReferenceID28</x:Reference>
                <x:Reference>__ReferenceID29</x:Reference>
                <x:Reference>__ReferenceID30</x:Reference>
                <x:Reference>__ReferenceID31</x:Reference>
                <x:Reference>__ReferenceID32</x:Reference>
                <x:Reference>__ReferenceID1</x:Reference>
                <x:Reference>__ReferenceID33</x:Reference>
                <x:Reference>__ReferenceID34</x:Reference>
                <x:Reference>__ReferenceID0</x:Reference>
                <x:Reference>__ReferenceID35</x:Reference>
                <x:Reference>__ReferenceID36</x:Reference>
                <x:Reference>__ReferenceID37</x:Reference>
                <x:Reference>__ReferenceID38</x:Reference>
                <x:Reference>__ReferenceID39</x:Reference>
                <x:Reference>__ReferenceID40</x:Reference>
                <x:Reference>__ReferenceID41</x:Reference>
                <x:Reference>__ReferenceID42</x:Reference>
                <x:Reference>__ReferenceID43</x:Reference>
                <x:Reference>__ReferenceID44</x:Reference>
                <x:Reference>__ReferenceID45</x:Reference>
                <x:Reference>__ReferenceID46</x:Reference>
                <x:Reference>__ReferenceID47</x:Reference>
                <x:Reference>__ReferenceID48</x:Reference>
              </Flowchart>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="848,1222" sap2010:WorkflowViewState.IdRef="Catch`1_2">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Sequence: Email Requestor, Move Mail and Retrhow Biz. Exp." sap:VirtualizedContainerService.HintSize="476,1153" sap2010:WorkflowViewState.IdRef="Sequence_11">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <umam:ForwardMail Account="[in_str_Account]" sap2010:Annotation.AnnotationText="Send email to requestor." Body="[&quot;Hello &quot; +out_o365m_ProcessingMail.Sender.DisplayName+Environment.NewLine+Environment.NewLine+&#xA;exp_Exception.Message+Environment.NewLine+Environment.NewLine+&#xA;&quot;Regards,&quot;+Environment.NewLine+&#xA;&quot;FFI Team&quot;]" DisplayName="Forward Mail: To requestor" sap:VirtualizedContainerService.HintSize="434,356" sap2010:WorkflowViewState.IdRef="ForwardMail_2" Message="[out_o365m_ProcessingMail]" To="[out_o365m_ProcessingMail.Sender.Address.Split(&quot;;&quot;c)]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </umam:ForwardMail>
                    <umam:MoveMail Account="[in_str_Account]" sap2010:Annotation.AnnotationText="Move email:&#xA;in_str_Account&#xA;o365m_ProcessingMail&#xA;&#xA;To:&#xA;in_str_RejectedFolder" DestinationFolderName="[in_str_RejectedFolder]" DisplayName="Move Mail: in_str_RejectedFolder" sap:VirtualizedContainerService.HintSize="434,234" sap2010:WorkflowViewState.IdRef="MoveMail_4" Message="[out_o365m_ProcessingMail]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </umam:MoveMail>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,91" sap2010:WorkflowViewState.IdRef="LogMessage_23" Level="Info" Message="[&quot;==FetchEmail== Biz. Exp. encountered, mail moved to mail folder: &quot; +in_str_RejectedFolder+ &quot;.&quot;]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:LogMessage>
                    <ui:SetTransactionStatus ContinueOnError="{x:Null}" Reason="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status: Assisgn in_dbl_AHT" ErrorType="Business" sap:VirtualizedContainerService.HintSize="434,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_1" Status="Successful" TransactionItem="[out_qi_TransactionItem]">
                      <ui:SetTransactionStatus.Analytics>
                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                      </ui:SetTransactionStatus.Analytics>
                      <ui:SetTransactionStatus.Output>
                        <InArgument x:TypeArguments="x:Double" x:Key="AHT">[in_dbl_AHT]</InArgument>
                      </ui:SetTransactionStatus.Output>
                    </ui:SetTransactionStatus>
                    <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status: Set Biz. Exp." ErrorType="Business" sap:VirtualizedContainerService.HintSize="434,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_2" Reason="[exception.Message]" Status="Failed" TransactionItem="[out_qi_TransactionItem]">
                      <ui:SetTransactionStatus.Analytics>
                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                      </ui:SetTransactionStatus.Analytics>
                      <ui:SetTransactionStatus.Output>
                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                      </ui:SetTransactionStatus.Output>
                    </ui:SetTransactionStatus>
                    <Rethrow DisplayName="Rethrow: Biz. Exp." sap:VirtualizedContainerService.HintSize="434,22" sap2010:WorkflowViewState.IdRef="Rethrow_3" />
                  </Sequence>
                </ActivityAction>
              </Catch>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="848,5096" sap2010:WorkflowViewState.IdRef="Catch`1_3">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                  </ActivityAction.Argument>
                  <Sequence sap2010:Annotation.AnnotationText="Catches specific errors known for their respective invalid inputs, then rethrows the error message with a more descriptive message included at the start." DisplayName="Sequence: Exception Handling" sap:VirtualizedContainerService.HintSize="526,5027" sap2010:WorkflowViewState.IdRef="Sequence_14">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign DisplayName="Assign: Initialise exp_Exception" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_19">
                      <Assign.To>
                        <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <If Condition="[exception.Message.Contains(&quot;An error occurred sending the request.&quot;)]" DisplayName="If: Error for AppId, TenantId, Username, Password" sap:VirtualizedContainerService.HintSize="484,378" sap2010:WorkflowViewState.IdRef="If_6">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to perform activities within 'Microsoft Office 365 Scope' due to the Application Id: '&quot; + in_str_ApplicationId + &quot;', Tenant Id: '&quot; + in_str_TenantId + &quot;', Username: '&quot; + in_str_Username + &quot;' or Password being incorrect. Exception message thrown: &quot; + exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,192" sap2010:WorkflowViewState.IdRef="Assign_12">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[New SystemException("Unable to perform activities within 'Microsoft Office 365 Scope' due to the Application Id: '" + in_str_ApplicationId + "', Tenant Id: '" + in_str_TenantId + "', Username: '" + in_str_Username + "' or Password being incorrect. Exception message thrown: " + exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exception.Message.Contains(&quot;Invalid hostname for this tenancy&quot;)]" DisplayName="If: Error for URL" sap:VirtualizedContainerService.HintSize="484,318" sap2010:WorkflowViewState.IdRef="If_7">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to get DriveItem using in_str_URL: '&quot; + in_str_SPSite + &quot;'. Exception message thrown: &quot; + exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="Assign_13">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[New SystemException("Unable to get DriveItem using in_str_URL: '" + in_str_SPSite + "'. Exception message thrown: " + exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exception.Message.Contains(&quot;The resource could not be found.&quot;)]" DisplayName="If: Error for SharePoint Folder" sap:VirtualizedContainerService.HintSize="484,318" sap2010:WorkflowViewState.IdRef="If_8">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to get DriveItem using in_str_SPRootFolder: '&quot; +in_str_SPRootFolder+ &quot;'. Exception message thrown: &quot; + exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="Assign_14">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[New SystemException("Unable to get DriveItem using in_str_SPRootFolder: '" +in_str_SPRootFolder+ "'. Exception message thrown: " + exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exception.Message.Contains(&quot;Resource could not be discovered.&quot;)]" DisplayName="If: Error for Mail Account" sap:VirtualizedContainerService.HintSize="484,348" sap2010:WorkflowViewState.IdRef="If_14">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to perform activities within 'Get Mail or Move Mail' due to the Mail Account: '&quot; + in_str_Account + &quot;' being incorrect. Exception message thrown: &quot; + exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,162" sap2010:WorkflowViewState.IdRef="Assign_20">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:SystemException">[New SystemException("Unable to perform activities within 'Get Mail or Move Mail' due to the Mail Account: '" + in_str_Account + "' being incorrect. Exception message thrown: " + exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exception.Message.Contains(&quot;Value cannot be null.&quot;)]" DisplayName="If: Error for Invalid Mail Folder" sap:VirtualizedContainerService.HintSize="484,393" sap2010:WorkflowViewState.IdRef="If_9">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to perform activities within 'Get Mail or Move Mail' due to the mail folder(s) Mail folder: '&quot; + in_str_MailFolder + &quot;' or Processing folder: '&quot; + in_str_ProcessingFolder + &quot;' or Rejected folder: '&quot; +in_str_RejectedFolder+&quot;' being incorrect. Exception message thrown: &quot; + exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,207" sap2010:WorkflowViewState.IdRef="Assign_15">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:SystemException">[New SystemException("Unable to perform activities within 'Get Mail or Move Mail' due to the mail folder(s) Mail folder: '" + in_str_MailFolder + "' or Processing folder: '" + in_str_ProcessingFolder + "' or Rejected folder: '" +in_str_RejectedFolder+"' being incorrect. Exception message thrown: " + exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exception.Message.ToLower.Contains(&quot;Storage Bucket '&quot; +in_str_StorageBucket+&quot;' not found&quot;)]" DisplayName="If: Error for Invalid Storage Bucket" sap:VirtualizedContainerService.HintSize="484,333" sap2010:WorkflowViewState.IdRef="If_11">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to add items to storage bucket as the storage bucket: '&quot;+in_str_StorageBucket+&quot;' is invalid. Exception message thrown: &quot;+Exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,147" sap2010:WorkflowViewState.IdRef="Assign_16">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:SystemException">[New SystemException("Unable to add items to storage bucket as the storage bucket: '"+in_str_StorageBucket+"' is invalid. Exception message thrown: "+Exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exception.Message.ToLower.Contains(in_str_QueueName+&quot; does not exist. error code: 1002&quot;)]" DisplayName="If: Error for Invalid Queue" sap:VirtualizedContainerService.HintSize="484,333" sap2010:WorkflowViewState.IdRef="If_10">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Unable to add a queue item as the orchestrator queue '&quot;+in_str_QueueName+&quot;' is invalid. Exception message thrown: &quot;+Exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,147" sap2010:WorkflowViewState.IdRef="Assign_17">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[New SystemException("Unable to add a queue item as the orchestrator queue '"+in_str_QueueName+"' is invalid. Exception message thrown: "+Exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[exp_Exception Is Nothing]" DisplayName="If: exp_Exception Is Nothing" sap:VirtualizedContainerService.HintSize="484,303" sap2010:WorkflowViewState.IdRef="If_13">
                      <If.Then>
                        <Assign sap2010:Annotation.AnnotationText="New SystemException(&quot;Exception occured due to following reason : &quot;+exception.Message)" DisplayName="Assign: exp_Exception" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_18">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[exp_Exception]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[New SystemException("Exception occured due to following reason : "+exception.Message)]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                      </If.Then>
                    </If>
                    <If Condition="[out_qi_TransactionItem IsNot Nothing]" DisplayName="If: Queue Item present?" sap:VirtualizedContainerService.HintSize="484,476" sap2010:WorkflowViewState.IdRef="If_12">
                      <If.Then>
                        <Sequence DisplayName="Sequence: Assign AHT and Mark Sys. Exp." sap:VirtualizedContainerService.HintSize="326,290" sap2010:WorkflowViewState.IdRef="Sequence_15">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:SetTransactionStatus ContinueOnError="{x:Null}" Reason="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status: Assisgn in_dbl_AHT" ErrorType="Business" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_5" Status="Successful" TransactionItem="[out_qi_TransactionItem]">
                            <ui:SetTransactionStatus.Analytics>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Analytics>
                            <ui:SetTransactionStatus.Output>
                              <InArgument x:TypeArguments="x:Double" x:Key="AHT">0</InArgument>
                            </ui:SetTransactionStatus.Output>
                          </ui:SetTransactionStatus>
                          <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status: Set Sys. Exp." ErrorType="Application" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_6" Reason="[exp_Exception.Message]" Status="Failed" TransactionItem="[out_qi_TransactionItem]">
                            <ui:SetTransactionStatus.Analytics>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Analytics>
                            <ui:SetTransactionStatus.Output>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Output>
                          </ui:SetTransactionStatus>
                        </Sequence>
                      </If.Then>
                      <If.Else>
                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_16">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Sequence>
                      </If.Else>
                    </If>
                    <If Condition="[out_di_Attachment IsNot Nothing]" DisplayName="If: out_di_Attachment IsNot Nothing, delete" sap:VirtualizedContainerService.HintSize="484,356" sap2010:WorkflowViewState.IdRef="If_15">
                      <If.Then>
                        <uma:Office365ApplicationScope ApplicationSecret="{x:Null}" CertificateAsBase64="{x:Null}" CertificatePassword="{x:Null}" ContinueOnError="{x:Null}" Password="{x:Null}" SecureApplicationSecret="{x:Null}" ApplicationId="[in_str_ApplicationId]" AuthenticationType="UsernameAndPassword" DisplayName="Microsoft Office 365 Scope" Environment="Global" sap:VirtualizedContainerService.HintSize="434,170" sap2010:WorkflowViewState.IdRef="Office365ApplicationScope_2" OAuthApplication="Custom" SecurePassword="[in_sstr_Password]" Services="Files" Tenant="[in_str_TenantId]" Timeout="300000" Username="[in_str_Username]">
                          <uma:Office365ApplicationScope.Body>
                            <ActivityAction x:TypeArguments="mg:GraphServiceClient">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="mg:GraphServiceClient" Name="ParentScope" />
                              </ActivityAction.Argument>
                              <umaf:DeleteItem DisplayName="Delete Item: out_di_Attachment" DriveItem="[out_di_Attachment]" sap:VirtualizedContainerService.HintSize="334,84" sap2010:WorkflowViewState.IdRef="DeleteItem_1" />
                            </ActivityAction>
                          </uma:Office365ApplicationScope.Body>
                        </uma:Office365ApplicationScope>
                      </If.Then>
                      <If.Else>
                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_17">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Sequence>
                      </If.Else>
                    </If>
                    <If Condition="[bln_ImgUploaded]" DisplayName="If: bln_ImgUploaded=True" sap:VirtualizedContainerService.HintSize="484,775" sap2010:WorkflowViewState.IdRef="If_16">
                      <If.Then>
                        <Sequence DisplayName="Sequence: Delete uploaded images" sap:VirtualizedContainerService.HintSize="376,589" sap2010:WorkflowViewState.IdRef="Sequence_20">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ucas:DeleteStorageFile TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Delete Pg2 img from storage bucket." DisplayName="Delete Storage File: Pg2.png" sap:VirtualizedContainerService.HintSize="334,163" sap2010:WorkflowViewState.IdRef="DeleteStorageFile_4" Path="[out_str_Pg2StoragePath]" StorageBucketName="[in_str_StorageBucket]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ucas:DeleteStorageFile>
                          <ucas:DeleteStorageFile TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Delete Pg6 img from storage bucket." DisplayName="Delete Storage File: Pg6.png" sap:VirtualizedContainerService.HintSize="334,163" sap2010:WorkflowViewState.IdRef="DeleteStorageFile_3" Path="[out_str_Pg6StoragePath]" StorageBucketName="[in_str_StorageBucket]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ucas:DeleteStorageFile>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_26" Level="Info" Message="[&quot;==FetchEmail== Storage files: &quot; +out_str_Pg2StoragePath+ &quot; and &quot; +out_str_Pg6StoragePath+ &quot; deleted from storage bucket: &quot; +in_str_StorageBucket+ &quot;.&quot;]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                        </Sequence>
                      </If.Then>
                      <If.Else>
                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_19">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Sequence>
                      </If.Else>
                    </If>
                    <Throw DisplayName="Throw: exp_Exception" Exception="[exp_Exception]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Throw_21" />
                  </Sequence>
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </ActivityAction>
      </uma:Office365ApplicationScope.Body>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </uma:Office365ApplicationScope>
  </Sequence>
</Activity>